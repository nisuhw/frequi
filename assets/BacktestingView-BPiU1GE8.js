import{m as z,c as k,a as c,e as u,a2 as Ie,a3 as Ue,a4 as re,a5 as He,Q as Fe,d as M,u as H,r as A,p as V,Y as se,b as s,f as e,i as D,h as m,F as S,v as U,t as x,q as b,g as F,j as $,x as Y,y as B,a6 as Ne,a1 as Z,B as N,o as J,N as le,a7 as je,K as E,I as Q,a8 as Oe,a9 as Ee,D as de,V as Ge,$ as We,s as ue,C as Ke,aa as Ze,ab as ie,w as G,G as me,L as Qe,ac as Ye,l as Je,Z as Xe,ad as et,U as tt,a0 as st}from"./index-DvLAGnun.js";import{_ as at,a as lt,b as ot,c as nt,s as rt}from"./index-Doq2u2i6.js";import{_ as oe}from"./DraggableContainer.vue_vue_type_script_setup_true_lang-BDRVbiOn.js";import{c as fe,i as it,d as ct}from"./TradeList.vue_vue_type_script_setup_true_lang-BB76ljQE.js";import{_ as _e,a as dt,b as ut,c as pe}from"./InfoBox.vue_vue_type_script_setup_true_lang-BB-U0Ls6.js";import{s as mt}from"./index-CUI1mW2F.js";import{_ as ft}from"./CandleChartContainer-_PpuK8xL.js";import{_ as _t,a as pt,b as kt}from"./TradesLogChart-BOZDQ2ee.js";import{u as ke,E as be,i as ve,a as ye,b as ge,c as he,d as Be}from"./installCanvasRenderer-Ccd6LHi5.js";import{d as bt,e as vt,i as yt,a as gt,b as xe,c as $e,f as we,g as ht}from"./chartZoom-Cx7pVw3C.js";import{s as W,a as K}from"./index-BNgjpS5Q.js";import{g as Re,a as ce,s as Bt,b as xt}from"./index-BEiDyDwr.js";import{s as $t}from"./index-DM2z3geS.js";import{_ as wt}from"./TimeRangeSelect.vue_vue_type_script_setup_true_lang-DyT5Ax3B.js";import{s as Rt}from"./index-BTWjBZV7.js";import{_ as Ct,a as Tt}from"./StrategySelect.vue_vue_type_script_setup_true_lang-v_n4_L_0.js";import{_ as Vt}from"./check-B2xX33QO.js";import"./index-CCmZthug.js";import"./index-DqAwVXQC.js";import"./plus-box-outline-BuK5eruA.js";import"./content-copy-D-cj8dx4.js";import"./index-lLzAw-TN.js";import"./index-B_SRQla_.js";const St={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Mt(f,t){return c(),k("svg",St,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6z"},null,-1)]))}const ne=z({name:"mdi-chevron-right",render:Mt});var qt=`
    .p-radiobutton-group {
        display: inline-flex;
    }
`,At={root:"p-radiobutton-group p-component"},Pt=Ie.extend({name:"radiobuttongroup",style:qt,classes:At}),Lt={name:"BaseRadioButtonGroup",extends:Ue,style:Pt,provide:function(){return{$pcRadioButtonGroup:this,$parentInstance:this}}},Ce={name:"RadioButtonGroup",extends:Lt,inheritAttrs:!1,data:function(){return{groupName:this.name}},watch:{name:function(t){this.groupName=t||re("radiobutton-group-")}},mounted:function(){this.groupName=this.groupName||re("radiobutton-group-")}};function Dt(f,t,l,p,r,a){return c(),k("div",Fe({class:f.cx("root")},f.ptmi("root")),[He(f.$slots,"default")],16)}Ce.render=Dt;const zt={class:"flex justify-center"},It=["for"],Ut={class:"divide-y divide-surface-300 dark:divide-surface-700 divide-solid border-x border-y rounded-sm border-surface-300 dark:border-surface-700"},Ht=["title","onClick"],Ft={class:"flex"},Nt={class:"flex flex-col"},jt={key:0},Ot={key:0},Et={class:"px-3 m-0 list-disc list-inside"},Gt={key:0},Wt=M({__name:"TradeListNav",props:{trades:{required:!0,type:Array},backtestMode:{required:!1,default:!1,type:Boolean}},emits:["trade-select"],setup(f,{emit:t}){const l=f,p=t,r=H(),a=A({}),i=A(!0),o=A("openDate"),n=[{text:"Open date",value:"openDate"},{text:"Profit %",value:"profit"}],d=y=>{a.value=y,p("trade-select",y)},g=V(()=>{const y=o.value==="profit"?"profit_ratio":"open_timestamp";return i.value?l.trades.slice().sort((v,w)=>w[y]-v[y]):l.trades.slice().sort((v,w)=>v[y]-w[y])}),_=A(g.value.map(()=>!1));return se(()=>r.activeBot.selectedPair,()=>{_.value=g.value.map(()=>!1)}),(y,v)=>{const w=mt,T=Ce,h=F,q=_e,R=dt,O=ut,X=ne,ee=Ne;return c(),k("div",null,[u("div",zt,[v[2]||(v[2]=u("span",{class:"me-2"},"Sort by:",-1)),s(T,{modelValue:e(o),"onUpdate:modelValue":v[0]||(v[0]=C=>D(o)?o.value=C:null),options:n,name:"radio-options"},{default:m(()=>[(c(),k(S,null,U(n,C=>u("div",{key:C.value,class:"flex items-center"},[s(w,{id:`id-${C.value}`,value:C.value},null,8,["id","value"]),u("label",{for:`id-${C.value}`},x(C.text),9,It)])),64))]),_:1},8,["modelValue"])]),u("ul",Ut,[s(h,{severity:"secondary",variant:"text",class:"w-full flex flex-wrap justify-center items-center",title:"Trade Navigation",onClick:v[1]||(v[1]=C=>i.value=!e(i))},{default:m(()=>[$("Trade Navigation "+x(e(i)?"↓":"↑"),1)]),_:1}),(c(!0),k(S,null,U(e(g),(C,I)=>(c(),k("li",{key:C.open_timestamp,class:Y(["flex flex-col py-1 px-1 items-stretch",{"bg-primary-100 dark:bg-primary-800 text-primary-contrast":C.open_timestamp===e(a).open_timestamp}]),title:`${C.pair}`,onClick:L=>d(C)},[u("div",Ft,[u("div",Nt,[u("div",null,[e(r).activeBot.botState.trading_mode!=="spot"?(c(),k("span",jt,x(C.is_short?"S-":"L-"),1)):b("",!0),s(q,{date:C.open_timestamp},null,8,["date"])]),s(R,{trade:C,class:"my-1"},null,8,["trade"]),f.backtestMode?(c(),B(O,{key:0,"profit-ratio":C.profit_ratio,"stake-currency":e(r).activeBot.stakeCurrency},null,8,["profit-ratio","stake-currency"])):b("",!0)]),s(h,{size:"small",class:"ms-auto mt-auto",variant:"outlined",severity:"secondary",onClick:L=>e(_)[I]=!e(_)[I]},{default:m(()=>[e(_)[I]?b("",!0):(c(),B(X,{key:0,width:"24",height:"24"})),e(_)[I]?(c(),B(ee,{key:1,width:"24",height:"24"})):b("",!0)]),_:2},1032,["onClick"])]),s(Z,null,{default:m(()=>[e(_)[I]?(c(),k("div",Ot,[u("ul",Et,[(c(!0),k(S,null,U(C.orders?.filter(L=>L.order_filled_timestamp!==null),L=>(c(),k("li",{key:L.order_timestamp},x(L.ft_order_side)+" "+x(L.amount)+" at "+x(L.safe_price),1))),128))])])):b("",!0)]),_:2},1024)],10,Ht))),128)),f.trades.length===0?(c(),k("div",Gt,"No trades to show...")):b("",!0)])])}}}),Kt=N(Wt,[["__scopeId","data-v-b76b1d1a"]]),Zt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qt(f,t){return c(),k("svg",Zt,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M15.41 16.58L10.83 12l4.58-4.59L14 6l-6 6l6 6z"},null,-1)]))}const Te=z({name:"mdi-chevron-left",render:Qt}),Yt={class:"flex flex-row mb-1 items-center"},Jt={class:"me-2"},Xt={class:"grow"},es={class:"text-end"},ts={class:"text-center flex flex-row h-full items-stretch"},ss=M({__name:"BacktestResultChart",props:{timeframe:{},strategy:{},freqaiModel:{},timerange:{},backtestResult:{}},setup(f){const t=f,l=H(),p=A({right:!0,left:!0}),r=A(),a=o=>{r.value={startValue:o.open_timestamp,endValue:o.close_timestamp}};function i(o,n){l.activeBot.getPairHistory({pair:o,timeframe:t.timeframe,timerange:t.timerange,strategy:t.strategy,freqaimodel:t.freqaiModel,columns:n,margin_mode:t.backtestResult.margin_mode,trading_mode:t.backtestResult.trading_mode})}return J(()=>{!l.activeBot.selectedPair&&t.backtestResult.pairlist.length>0&&([l.activeBot.selectedPair]=t.backtestResult.pairlist)}),(o,n)=>{const d=ne,g=Te,_=F,y=at,v=ft,w=Kt,T=fe,h=oe;return c(),k("div",null,[u("div",Yt,[u("div",Jt,[s(_,{"aria-label":"Close",title:"Pair Navigation",severity:"secondary",variant:"outlined",size:"small",onClick:n[0]||(n[0]=q=>e(p).left=!e(p).left)},{default:m(()=>[e(p).left?b("",!0):(c(),B(d,{key:0,width:"24",height:"24"})),e(p).left?(c(),B(g,{key:1,width:"24",height:"24"})):b("",!0)]),_:1})]),u("span",Xt,[n[2]||(n[2]=$(" Graph will always show the latest values for the selected strategy. ")),n[3]||(n[3]=u("br",null,null,-1)),$(" Timerange: "+x(o.timerange)+" - "+x(o.strategy),1)]),u("div",es,[s(_,{"aria-label":"Close",variant:"outlined",title:"Trade Navigation",size:"small",severity:"secondary",onClick:n[1]||(n[1]=q=>e(p).right=!e(p).right)},{default:m(()=>[e(p).right?(c(),B(d,{key:0,width:"24",height:"24"})):b("",!0),e(p).right?b("",!0):(c(),B(g,{key:1,width:"24",height:"24"}))]),_:1})])]),u("div",ts,[s(Z,{name:"fadeleft"},{default:m(()=>[e(p).left?(c(),B(y,{key:0,class:"overflow-y-auto overflow-x-hidden",style:{"max-height":"calc(100vh - 200px)"},pairlist:o.backtestResult.pairlist,trades:o.backtestResult.trades,"starting-balance":o.backtestResult.starting_balance,"sort-method":"profit","backtest-mode":!0},null,8,["pairlist","trades","starting-balance"])):b("",!0)]),_:1}),s(v,{"available-pairs":o.backtestResult.pairlist,"historic-view":"","reload-data-on-switch":"",timeframe:o.timeframe,timerange:o.timerange,strategy:o.strategy,trades:o.backtestResult.trades,class:"flex-shrink-1 candle-chart-container w-full px-0 h-full align-self-stretch","slider-position":e(r),"freqai-model":o.freqaiModel,onRefreshData:i},null,8,["available-pairs","timeframe","timerange","strategy","trades","slider-position","freqai-model"]),s(Z,{name:"fade"},{default:m(()=>[e(p).right?(c(),B(w,{key:0,class:"overflow-y-auto overflow-x-visible min-w-56",style:{"max-height":"calc(100vh - 200px)"},trades:o.backtestResult.trades.filter(q=>q.pair===e(l).activeBot.selectedPair),onTradeSelect:a},null,8,["trades"])):b("",!0)]),_:1})]),s(h,{header:"Single trades",class:"row mt-2 w-full"},{default:m(()=>[s(T,{class:"row trade-history mt-2 w-full",trades:o.backtestResult.trades,"show-filter":!0},null,8,["trades"])]),_:1})])}}}),as=N(ss,[["__scopeId","data-v-3b315781"]]),te="Market change %",ls=M({__name:"MarketChangeChart",props:{marketChangeData:{},showTitle:{type:Boolean,default:!0}},setup(f){ke([yt,gt,ve,xe,ye,$e,ge,he,Be,we]);const t=f,l=le(),p=A(null),r=V(()=>{if(!t.marketChangeData)return{};const a=t.marketChangeData.columns.findIndex(o=>o==="__date_ts"),i=t.marketChangeData.columns.findIndex(o=>o==="rel_mean");return{title:{text:"Market change %",left:"center",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{source:t.marketChangeData.data},tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},grid:{...vt},legend:{data:[te],right:"5%",selectedMode:!1},xAxis:[{type:"time",axisLine:{onZero:!1},axisTick:{show:!0},axisLabel:{show:!0},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"}],yAxis:[{type:"value",name:te,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:35}],dataZoom:[{type:"inside",start:0,end:100},{bottom:10,start:0,end:100,...bt}],series:[{type:"line",name:te,showSymbol:!1,color:l.chartTheme==="dark"?"#c2c2c2":"black",encode:{x:a,y:i}}]}});return(a,i)=>a.marketChangeData?.data?(c(),B(e(be),{key:0,ref_key:"marketChangeChart",ref:p,option:e(r),theme:e(l).chartTheme,autoresize:""},null,8,["option","theme"])):b("",!0)}}),os=N(ls,[["__scopeId","data-v-2efdd613"]]),ns=M({__name:"TradeDurationChart",props:{trades:{},showTitle:{type:Boolean,default:!0}},setup(f){const t=f,l=le();ke([ye,he,Be,xe,ge,$e,it,ct,ve,we,ht]);const p=V(()=>t.trades.map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),r=V(()=>t.trades.filter(n=>n.profit_ratio>0).map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),a=V(()=>t.trades.filter(n=>n.profit_ratio<=0).map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),i=V(()=>({title:{text:"Trades durations",left:"center",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:[{id:"allTrades",source:[p.value,r.value,a.value]},{id:"allTradesBoxplot",fromDatasetId:"allTrades",transform:{type:"boxplot",config:{itemNameFormatter:n=>{if(n.value===0)return"All trades";if(n.value===1)return"Winning trades";if(n.value===2)return"Losing trades"}}}},{id:"outlier",fromDatasetIndex:1,fromTransformResult:1}],xAxis:{type:"category",show:!0},yAxis:[{type:"value",name:"Trade duration",splitArea:{show:!0},axisLabel:{formatter:o}}],tooltip:{formatter:n=>{if(n.seriesType==="boxplot"){const d=n.data;return`
            <div>${n.name}</div>
            <div>Min: ${o(d[1])}</div>
            <div>Q1: ${o(d[2])}</div>
            <div>Median: ${o(d[3])}</div>
            <div>Q3: ${o(d[4])}</div>
            <div>Max: ${o(d[5])}</div>
          `}return""}},visualMap:[{type:"piecewise",show:!1,dimension:0,pieces:[{min:0,max:0,label:"All Trades",color:"#5470c6"},{min:1,max:1,label:"Winning Trades",color:"#12bb7b"},{min:2,max:2,label:"Losing Trades",color:"#ef5350"}]}],series:[{name:"Trade durations",type:"boxplot",datasetId:"allTradesBoxplot",colorBy:"data"},{name:"outlier",type:"scatter",datasetId:"outlier"}]}));function o(n){if(n>=60){const d=Math.floor(n/60),g=Math.floor(n%60);return`${d}h ${g}m`}return`${Math.floor(n)}m`}return(n,d)=>n.trades.length>0?(c(),B(e(be),{key:0,option:e(i),autoresize:"",theme:e(l).chartTheme},null,8,["option","theme"])):b("",!0)}}),rs=N(ns,[["__scopeId","data-v-fe032d24"]]),is={class:"text-center flex-fill flex flex-col h-full gap-1"},cs=M({__name:"BacktestGraphs",props:{trades:{required:!0,type:Array}},setup(f){const t=H(),{state:l}=je(()=>t.activeBot.getBacktestMarketChange(),null);return(p,r)=>{const a=_t,i=pt,o=os,n=kt;return c(),k("div",is,[s(a,{trades:f.trades,class:"flex-grow-1 chart-equal-height"},null,8,["trades"]),s(rs,{class:"flex-grow-1 chart-equal-height",trades:f.trades,"show-title":!0},null,8,["trades"]),s(i,{trades:f.trades,class:"flex-grow-1 chart-equal-height","show-title":!0},null,8,["trades"]),e(l)?(c(),B(o,{key:0,"market-change-data":e(l),class:"flex-grow-1 chart-equal-height"},null,8,["market-change-data"])):b("",!0),s(n,{class:"flex-grow-1 chart-equal-height",trades:f.trades,"show-title":!0},null,8,["trades"])])}}}),ds=N(cs,[["__scopeId","data-v-98097119"]]),us={class:"flex flex-col me-2 text-start"},ms={class:"font-bold"},fs={class:"text-sm"},_s={key:0,class:"text-sm",style:{"white-space":"pre-wrap"}},Ve=M({__name:"BacktestResultSelectEntry",props:{backtestResult:{required:!0,type:Object},selectedBacktestResultKey:{required:!1,default:"",type:String},canUseModify:{required:!1,default:!1,type:Boolean}},setup(f){return(t,l)=>(c(),k("div",us,[u("div",ms,x(f.backtestResult.metadata.strategyName)+" - "+x(f.backtestResult.strategy.timeframe),1),u("div",fs," TradeCount: "+x(f.backtestResult.strategy.total_trades)+" - Profit: "+x(("formatPercent"in t?t.formatPercent:e(E))(f.backtestResult.strategy.profit_total)),1),f.canUseModify?(c(),k("div",_s,x(f.backtestResult.metadata.notes),1)):b("",!0)]))}});function ae(f,t){return Object.entries(f).reduce((p,[r,a])=>(a.forEach(i=>{const[o,n]=Object.entries(i)[0],d=p.find(g=>g[t]===o);d?d[r]=n:p.push({[t]:o,[r]:n})}),p),[])}const ps={class:"px-0 mw-full"},ks={class:"flex flex-col text-start ms-0 me-2 gap-2"},bs={class:"flex flex-col flex-xl-row"},vs={class:"px-0 xl:px-0 pt-2 xl:pt-0 xl:ps-1 flex-fill"},ys={key:1},gs=M({__name:"BacktestResultComparison",props:{backtestResults:{required:!0,type:Object}},setup(f){const t=f,l=V(()=>{const r={};return Object.entries(t.backtestResults).forEach(([a,i])=>{const o=Re(i.strategy);r[a]=o}),console.log(r),ae(r,"metric")}),p=V(()=>{const r=[{key:"metric",label:"Metric"}];return Object.entries(t.backtestResults).forEach(([a,i])=>{r.push({key:a,label:i.metadata.strategyName})}),r});return(r,a)=>{const i=Ve,o=K,n=W;return c(),k("div",ps,[a[0]||(a[0]=u("div",{class:"flex justify-center"},[u("h3",{class:"font-bold text-3xl"},"Backtest-result comparison")],-1)),u("div",ks,[u("div",bs,[u("div",vs,[s(n,{bordered:"",value:e(l),size:"small","show-gridlines":""},{default:m(()=>[(c(!0),k(S,null,U(e(p),d=>(c(),B(o,{key:d.key,field:d.key,label:d.label},{header:m(()=>[d.key&&d.key in f.backtestResults?(c(),B(i,{key:0,"backtest-result":f.backtestResults[d.key]},null,8,["backtest-result"])):(c(),k("span",ys,x(d.label),1))]),_:2},1032,["field","label"]))),128))]),_:1},8,["value"])])])])])}}}),hs=M({__name:"BacktestResultPeriodBreakdown",props:{periodicBreakdown:{}},setup(f){const t=f,l=V(()=>{const r=[{value:"day",text:"Days"},{value:"week",text:"Weeks"},{value:"month",text:"Months"}];return t.periodicBreakdown.year&&r.push({value:"year",text:"Years"}),r}),p=A("month");return(r,a)=>{const i=$t,o=K,n=W;return c(),k(S,null,[s(i,{modelValue:e(p),"onUpdate:modelValue":a[0]||(a[0]=d=>D(p)?p.value=d:null),options:e(l),size:"small","allow-empty":!1,class:"m-2","option-label":"text","option-value":"value"},null,8,["modelValue","options"]),s(n,{size:"small",stacked:"sm",value:r.periodicBreakdown[e(p)]},{default:m(()=>[s(o,{field:"date",header:"Date"}),s(o,{field:"trades",header:"Trades"},{body:m(({data:d,field:g})=>[$(x(d[g]??"N/A"),1)]),_:1}),s(o,{field:"profit_abs",header:"Total Profit",body:"formatPrice"in r?r.formatPrice:e(Q)},{body:m(({data:d,field:g})=>[$(x(d[g]?d[g].toFixed(2):"N/A"),1)]),_:1},8,["body"]),s(o,{field:"profit_factor",header:"Profit Factor"},{body:m(({data:d,field:g})=>[$(x(("formatPrice"in r?r.formatPrice:e(Q))(d[g],2)),1)]),_:1}),s(o,{field:"wins",header:"Wins"}),s(o,{field:"draws",header:"Draws"}),s(o,{field:"losses",header:"Losses"},{body:m(({data:d})=>[$(x(d.loses??d.losses??"N/A"),1)]),_:1}),s(o,{field:"wins",header:"Win Rate"},{body:m(({data:d})=>[$(x((d.wins/(d.wins+d.draws+(d.loses??d.losses))*100).toFixed(2)+"%"),1)]),_:1})]),_:1},8,["value"])],64)}}}),Bs={class:"flex flex-row w-full justify-between items-center"},xs=M({__name:"BacktestResultTablePer",props:{title:{},results:{},stakeCurrency:{},stakeCurrencyDecimals:{},keyHeader:{default:""},keyHeaders:{default:()=>[]}},setup(f){const t=f,l=V(()=>t.results.map(i=>t.keyHeaders.length>0?{...i,key:typeof i.key=="string"?Array(t.keyHeaders.length).fill(i.key):i.key}:i)),p=V(()=>{const i=[];if(t.keyHeaders.length>0)for(let o=0;o<t.keyHeaders.length;o+=1)i.push({key:`key[${o}]`,label:t.keyHeaders[o],formatter:(n,d)=>Array.isArray(n)?n[o]:n||d.exit_reason||"OTHER"});else i.push({key:"key",label:t.keyHeader,formatter:(o,n)=>o||n.exit_reason||"OTHER"});return i}),r=le(),a=V(()=>ce.value.filter(i=>i.field!=="key"&&r.backtestAdditionalMetrics.includes(i.field)));return(i,o)=>{const n=Bt,d=K,g=W,_=oe;return c(),B(_,null,{header:m(()=>[u("div",Bs,[$(x(i.title)+" ",1),u("div",null,[o[1]||(o[1]=$(" Shown metrics: ")),s(n,{id:"backtestMetrics",modelValue:e(r).backtestAdditionalMetrics,"onUpdate:modelValue":o[0]||(o[0]=y=>e(r).backtestAdditionalMetrics=y),options:"availableBacktestMetrics"in i?i.availableBacktestMetrics:e(ce),"option-label":"header","option-value":"field",size:"small"},null,8,["modelValue","options"])])])]),default:m(()=>[s(g,{size:"small",hover:"",stacked:"sm",value:e(l)},{default:m(()=>[(c(!0),k(S,null,U(e(p),y=>(c(),B(d,{key:y.key,field:y.key,header:y.label},{body:m(({data:v})=>[$(x(y.formatter(v.key,v)),1)]),_:2},1032,["field","header"]))),128)),s(d,{field:"trades",header:"Trades"}),s(d,{field:"profit_mean",header:"Avg Profit %"},{body:m(({data:y,field:v})=>[$(x(("formatPercent"in i?i.formatPercent:e(E))(y[v],2)),1)]),_:1}),s(d,{field:"profit_total_abs",header:`Tot Profit ${t.stakeCurrency}`},{body:m(({data:y,field:v})=>[$(x(("formatPrice"in i?i.formatPrice:e(Q))(y[v],t.stakeCurrencyDecimals)),1)]),_:1},8,["header"]),s(d,{field:"profit_total",header:"Tot Profit %"},{body:m(({data:y,field:v})=>[$(x(("formatPercent"in i?i.formatPercent:e(E))(y[v],2)),1)]),_:1}),s(d,{field:"wins",header:"Wins"}),s(d,{field:"draws",header:"Draws"}),s(d,{field:"losses",header:"Losses"}),(c(!0),k(S,null,U(e(a),y=>(c(),B(d,{key:y.field,field:y.field,header:y.header},{body:m(({data:v,field:w})=>[$(x(y.is_ratio?("formatPercent"in i?i.formatPercent:e(E))(v[w],2):("formatPrice"in i?i.formatPrice:e(Q))(v[w],2)),1)]),_:2},1032,["field","header"]))),128))]),_:1},8,["value"])]),_:1})}}}),$s={class:"px-0 w-full"},ws={class:"flex justify-center"},Rs={class:"font-bold text-2xl mb-2"},Cs={class:"flex flex-col text-start ms-0 me-2 gap-2"},Ts={class:"flex flex-col xl:flex-row"},Vs={class:"px-0 px-xl-0 pe-xl-1 grow"},Ss={class:"px-0 xl:px-0 pt-2 xl:pt-0 xl:ps-1 grow"},Ms=M({__name:"BacktestResultAnalysis",props:{backtestResult:{}},setup(f){const t=f,l=V(()=>{const r=Re(t.backtestResult);return ae({value:r},"metric")}),p=V(()=>{const r=xt(t.backtestResult);return ae({value:r},"setting")});return(r,a)=>{const i=K,o=W,n=oe,d=xs,g=hs,_=fe;return c(),k("div",$s,[u("div",ws,[u("h3",Rs," Backtest-result for "+x(r.backtestResult.strategy_name),1)]),u("div",Cs,[u("div",Ts,[u("div",Vs,[s(n,{header:"Strategy settings"},{default:m(()=>[s(o,{size:"small",value:e(p)},{default:m(()=>[s(i,{field:"setting",header:"Setting"}),s(i,{field:"value",header:"Value"})]),_:1},8,["value"])]),_:1})]),u("div",Ss,[s(n,{header:"Metrics"},{default:m(()=>[s(o,{size:"small",borderless:"",value:e(l)},{default:m(()=>[s(i,{field:"metric",header:"Metric"}),s(i,{field:"value",header:"Value"})]),_:1},8,["value"])]),_:1})])]),s(d,{title:"Results per Enter tag",results:r.backtestResult.results_per_enter_tag,"stake-currency":r.backtestResult.stake_currency,"key-header":"Enter Tag","stake-currency-decimals":r.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),s(d,{title:"Results per Exit reason",results:r.backtestResult.exit_reason_summary??[],"stake-currency":r.backtestResult.stake_currency,"key-header":"Exit Reason","stake-currency-decimals":r.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),r.backtestResult.mix_tag_stats?(c(),B(d,{key:0,title:"Results Mixed Tag",results:r.backtestResult.mix_tag_stats??[],"stake-currency":r.backtestResult.stake_currency,"key-headers":["Enter Tag","Exit Tag"],"stake-currency-decimals":r.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"])):b("",!0),s(d,{title:"Results per pair",results:r.backtestResult.results_per_pair,"stake-currency":r.backtestResult.stake_currency,"key-header":"Pair","stake-currency-decimals":r.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),r.backtestResult.periodic_breakdown?(c(),B(n,{key:1,header:"Periodic breakdown"},{default:m(()=>[s(g,{"periodic-breakdown":r.backtestResult.periodic_breakdown},null,8,["periodic-breakdown"])]),_:1})):b("",!0),s(n,{header:"Single trades"},{default:m(()=>[s(_,{trades:r.backtestResult.trades,"show-filter":!0,"stake-currency":r.backtestResult.stake_currency},null,8,["trades","stake-currency"])]),_:1})])])}}}),qs={class:"w-full flex"},As={class:"ms-2"},Ps=M({__name:"FreqaiModelSelect",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(f){const t=Oe(f,"modelValue"),l=H();return J(()=>{l.activeBot.freqaiModelList.length===0&&l.activeBot.getFreqAIModelList()}),(p,r)=>{const a=Ee,i=de,o=F;return c(),k("div",null,[u("div",qs,[s(a,{modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=n=>t.value=n),options:e(l).activeBot.freqaiModelList,fluid:"",size:"small"},null,8,["modelValue","options"]),u("div",As,[s(o,{severity:"secondary",variant:"outlined",size:"small",onClick:e(l).activeBot.getFreqAIModelList},{icon:m(()=>[s(i)]),_:1},8,["onClick"])])])])}}}),Se=Ge("btStore",{state:()=>({strategy:"",selectedTimeframe:"",selectedDetailTimeframe:"",timerange:"",maxOpenTrades:null,stakeAmount:null,startingCapital:null,allowCache:!0,enableProtections:!1,stakeAmountUnlimited:!1,freqAI:{enabled:!1,model:"",identifier:""}}),getters:{canRunBacktest:f=>f.strategy!==""},actions:{}}),Ls={class:"mb-2"},Ds=["disabled"],zs={for:"timeframe-detail-select",class:"flex justify-end items-center gap-2"},Is={class:"flex items-center"},Us={class:"flex basis-full"},Hs={class:"flex justify-end items-center"},Fs={class:"flex flex-wrap md:flex-nowrap justify-between md:justify-center"},Ns=M({__name:"BacktestRun",setup(f){const t=H(),l=Se();function p(){const r={strategy:l.strategy,timerange:l.timerange,enable_protections:l.enableProtections};if(l.maxOpenTrades&&(r.max_open_trades=l.maxOpenTrades),l.stakeAmountUnlimited)r.stake_amount="unlimited";else{const i=Number(l.stakeAmount);i&&(r.stake_amount=i.toString())}const a=Number(l.startingCapital);a&&(r.dry_run_wallet=a),l.selectedTimeframe&&(r.timeframe=l.selectedTimeframe),l.selectedDetailTimeframe&&(r.timeframe_detail=l.selectedDetailTimeframe),l.allowCache||(r.backtest_cache="none"),l.freqAI.enabled&&(r.freqaimodel=l.freqAI.model,l.freqAI.identifier!==""&&(r.freqai={identifier:l.freqAI.identifier})),t.activeBot.startBacktest(r)}return(r,a)=>{const i=Ct,o=Tt,n=pe,d=Rt,g=We,_=ue,y=Ps,v=Ke,w=wt,T=F;return c(),k(S,null,[u("div",Ls,[a[13]||(a[13]=u("span",null,"Strategy",-1)),s(i,{modelValue:e(l).strategy,"onUpdate:modelValue":a[0]||(a[0]=h=>e(l).strategy=h)},null,8,["modelValue"])]),u("div",{class:"grid grid-cols-2 border border-surface-500 rounded-sm gap-y-2 gap-2 items-center p-1 pt-3",disabled:e(t).activeBot.backtestRunning},[a[20]||(a[20]=u("h3",{class:"font-bold mb-2 col-span-2 text-center"},"Backtesting parameters",-1)),a[21]||(a[21]=u("label",{for:"timeframe-select"},"Timeframe:",-1)),s(o,{id:"timeframe-select",modelValue:e(l).selectedTimeframe,"onUpdate:modelValue":a[1]||(a[1]=h=>e(l).selectedTimeframe=h),size:"small"},null,8,["modelValue"]),u("label",zs,[a[14]||(a[14]=$("Detail Timeframe: ")),s(n,{hint:"Detail timeframe, to simulate intra-candle results. Not setting this will not use this functionality."})]),s(o,{id:"timeframe-detail-select",modelValue:e(l).selectedDetailTimeframe,"onUpdate:modelValue":a[2]||(a[2]=h=>e(l).selectedDetailTimeframe=h),size:"small","below-timeframe":e(l).selectedTimeframe},null,8,["modelValue","below-timeframe"]),a[22]||(a[22]=u("label",{for:"max-open-trades"},"Max open trades:",-1)),s(d,{id:"max-open-trades",modelValue:e(l).maxOpenTrades,"onUpdate:modelValue":a[3]||(a[3]=h=>e(l).maxOpenTrades=h),size:"small",placeholder:"Use strategy default",type:"number"},null,8,["modelValue"]),a[23]||(a[23]=u("label",{for:"starting-capital"},"Starting capital:",-1)),s(d,{id:"starting-capital",modelValue:e(l).startingCapital,"onUpdate:modelValue":a[4]||(a[4]=h=>e(l).startingCapital=h),size:"small",placeholder:"Use config default",type:"number",step:.001},null,8,["modelValue"]),a[24]||(a[24]=u("label",{for:"stake-amount-bool"},"Stake amount:",-1)),u("div",Is,[u("div",Us,[s(g,{id:"stake-amount-bool",modelValue:e(l).stakeAmountUnlimited,"onUpdate:modelValue":a[5]||(a[5]=h=>e(l).stakeAmountUnlimited=h)},{default:m(()=>a[15]||(a[15]=[$("Unlimited stake")])),_:1,__:[15]},8,["modelValue"])]),s(d,{id:"stake-amount",modelValue:e(l).stakeAmount,"onUpdate:modelValue":a[6]||(a[6]=h=>e(l).stakeAmount=h),placeholder:"Use strategy default",step:.01,size:"small",disabled:e(l).stakeAmountUnlimited},null,8,["modelValue","disabled"])]),a[25]||(a[25]=u("label",{for:"enable-protections"},"Enable Protections:",-1)),s(g,{id:"enable-protections",modelValue:e(l).enableProtections,"onUpdate:modelValue":a[7]||(a[7]=h=>e(l).enableProtections=h)},null,8,["modelValue"]),e(t).activeBot.botFeatures.backtestFreqAI?(c(),k(S,{key:0},[a[16]||(a[16]=u("label",{for:"enable-cache"},"Cache Backtest results:",-1)),s(g,{id:"enable-cache",modelValue:e(l).allowCache,"onUpdate:modelValue":a[8]||(a[8]=h=>e(l).allowCache=h)},null,8,["modelValue"])],64)):b("",!0),e(t).activeBot.botFeatures.backtestFreqAI?(c(),k(S,{key:1},[u("div",Hs,[a[17]||(a[17]=u("span",{class:"me-2"},"Enable FreqAI:",-1)),s(n,{hint:"Assumes freqAI configuration is setup in the configuration, and the strategy is a freqAI strategy. Will fail if that's not the case."})]),s(g,{id:"enable-freqai",modelValue:e(l).freqAI.enabled,"onUpdate:modelValue":a[9]||(a[9]=h=>e(l).freqAI.enabled=h)},null,8,["modelValue"]),e(l).freqAI.enabled?(c(),k(S,{key:0},[a[18]||(a[18]=u("label",{for:"freqai-identifier"},"FreqAI identifier:",-1)),s(_,{id:"freqai-identifier",modelValue:e(l).freqAI.identifier,"onUpdate:modelValue":a[10]||(a[10]=h=>e(l).freqAI.identifier=h),placeholder:"Use config default",size:"small"},null,8,["modelValue"])],64)):b("",!0),e(l).freqAI.enabled?(c(),k(S,{key:1},[a[19]||(a[19]=u("label",{for:"freqai-model"},"FreqAI Model:",-1)),s(y,{id:"freqai-model",modelValue:e(l).freqAI.model,"onUpdate:modelValue":a[11]||(a[11]=h=>e(l).freqAI.model=h)},null,8,["modelValue"])],64)):b("",!0)],64)):b("",!0),s(v,{class:"col-span-2"}),s(w,{modelValue:e(l).timerange,"onUpdate:modelValue":a[12]||(a[12]=h=>e(l).timerange=h),class:"mx-auto mt-2 col-span-2"},null,8,["modelValue"])],8,Ds),a[30]||(a[30]=u("h3",{class:"mt-3 font-bold text-2xl"},"Backtesting summary",-1)),u("div",Fs,[s(T,{id:"start-backtest",severity:"primary",disabled:!e(l).canRunBacktest||e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,class:"mx-1",onClick:p},{default:m(()=>a[26]||(a[26]=[$(" Start backtest ")])),_:1,__:[26]},8,["disabled"]),s(T,{severity:"secondary",disabled:e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,class:"mx-1",onClick:e(t).activeBot.pollBacktest},{default:m(()=>a[27]||(a[27]=[$(" Load backtest result ")])),_:1,__:[27]},8,["disabled","onClick"]),s(T,{severity:"secondary",class:"mx-1",disabled:!e(t).activeBot.backtestRunning,onClick:e(t).activeBot.stopBacktest},{default:m(()=>a[28]||(a[28]=[$(" Stop Backtest ")])),_:1,__:[28]},8,["disabled","onClick"]),s(T,{severity:"secondary",class:"mx-1",disabled:e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,onClick:e(t).activeBot.removeBacktest},{default:m(()=>a[29]||(a[29]=[$(" Reset Backtest ")])),_:1,__:[29]},8,["disabled","onClick"])])],64)}}}),js=N(Ns,[["__scopeId","data-v-ef4e8e18"]]),Os={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Es(f,t){return c(),k("svg",Os,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M4 11v2h12l-5.5 5.5l1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5L16 11z"},null,-1)]))}const Gs=z({name:"mdi-arrow-right",render:Es}),Ws={key:0,class:"flex align-center"},Ks={key:0,class:"ms-1"},Zs={class:"flex items-center"},Qs=M({__name:"BacktestHistoryLoad",setup(f){const t=H(),l=A(),p=A(""),r=Ze(p,350,{maxWait:1e3});J(()=>{t.activeBot.getBacktestHistory()});function a(n){const d={title:"Delete result",message:`Delete result ${n.filename} from disk?`,accept:()=>{t.activeBot.deleteBacktestHistoryResult(n)}};l.value?.show(d)}const i=V(()=>t.activeBot.backtestHistoryList.filter(n=>n.filename.toLowerCase().includes(r.value.toLowerCase())||n.strategy.toLowerCase().includes(r.value.toLowerCase())));function o(n){t.activeBot.getBacktestHistoryResult(n.data)}return(n,d)=>{const g=de,_=F,y=ue,v=K,w=_e,T=Gs,h=me,q=W;return c(),k(S,null,[u("div",null,[s(_,{class:"float-end",title:"Refresh","aria-label":"Refresh",variant:"outlined",severity:"secondary",onClick:e(t).activeBot.getBacktestHistory},{default:m(()=>[s(g)]),_:1},8,["onClick"]),d[1]||(d[1]=u("p",null," Load Historic results from disk. You can click on multiple results to load all of them into freqUI. ",-1)),e(t).activeBot.backtestHistoryList.length>0?(c(),k("div",Ws,[s(y,{id:"trade-filter",modelValue:e(p),"onUpdate:modelValue":d[0]||(d[0]=R=>D(p)?p.value=R:null),type:"text",size:"small",placeholder:"Filter results",title:"Filter results"},null,8,["modelValue"])])):b("",!0),e(t).activeBot.backtestHistoryList.length>0?(c(),B(q,{key:1,class:"mt-2",responsive:"",size:"small",scrollable:"","scroll-height":"50rem","virtual-scroller-options":{itemSize:46},"show-gridlines":"",value:e(i),onRowClick:o},{default:m(()=>[s(v,{field:"strategy",header:"Strategy2"}),s(v,{field:"timeframe",header:"Details"},{body:m(({data:R})=>[u("strong",null,x(R.timeframe),1),R.backtest_start_ts&&R.backtest_end_ts?(c(),k("span",Ks,x(("timestampToTimeRangeString"in n?n.timestampToTimeRangeString:e(ie))(R.backtest_start_ts*1e3))+"-"+x(("timestampToTimeRangeString"in n?n.timestampToTimeRangeString:e(ie))(R.backtest_end_ts*1e3)),1)):b("",!0)]),_:1}),s(v,{field:"backtest_start_time",header:"Backtest Time"},{body:m(({data:R})=>[s(w,{date:R.backtest_start_time*1e3},null,8,["date"])]),_:1}),s(v,{field:"filename",header:"Filename"}),s(v,{field:"actions",header:"Actions"},{body:m(({data:R})=>[u("div",Zs,[e(t).activeBot.botFeatures.backtestSetNotes?(c(),B(pe,{key:0,class:Y(R.notes?"opacity-100":"opacity-0"),hint:R.notes??""},null,8,["class","hint"])):b("",!0),e(t).activeBot.botFeatures.backtestDelete?(c(),B(_,{key:1,class:"ms-1",size:"small",title:"Load this Result.",disabled:R.run_id in e(t).activeBot.backtestHistory,onClick:G(O=>e(t).activeBot.getBacktestHistoryResult(R),["stop"])},{icon:m(()=>[s(T)]),_:2},1032,["disabled","onClick"])):b("",!0),e(t).activeBot.botFeatures.backtestDelete?(c(),B(_,{key:2,class:"ms-1",size:"small",severity:"secondary",title:"Delete this Result.",disabled:R.run_id in e(t).activeBot.backtestHistory,onClick:G(O=>a(R),["stop"])},{icon:m(()=>[s(h)]),_:2},1032,["disabled","onClick"])):b("",!0)])]),_:1})]),_:1},8,["value"])):b("",!0)]),s(Qe,{ref_key:"msgBox",ref:l},null,512)],64)}}}),Ys={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Js(f,t){return c(),k("svg",Ys,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M21 8c-1.5 0-2.3 1.4-1.9 2.5l-3.6 3.6c-.3-.1-.7-.1-1 0l-2.6-2.6c.4-1.1-.4-2.5-1.9-2.5c-1.4 0-2.3 1.4-1.9 2.5L3.5 16c-1.1-.3-2.5.5-2.5 2c0 1.1.9 2 2 2c1.4 0 2.3-1.4 1.9-2.5l4.5-4.6c.3.1.7.1 1 0l2.6 2.6c-.3 1 .5 2.5 2 2.5s2.3-1.4 1.9-2.5l3.6-3.6c1.1.3 2.5-.5 2.5-1.9c0-1.1-.9-2-2-2m-6 1l.9-2.1L18 6l-2.1-.9L15 3l-.9 2.1L12 6l2.1.9zM3.5 11L4 9l2-.5L4 8l-.5-2L3 8l-2 .5L3 9z"},null,-1)]))}const Xs=z({name:"mdi-chart-timeline-variant-shimmer",render:Js}),ea={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ta(f,t){return c(),k("svg",ea,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M4 19v1h18v2H2V2h2v15c3 0 6-2 8.1-5.6c3-5 6.3-7.4 9.9-7.4v2c-2.8 0-5.5 2.1-8.1 6.5C11.3 16.6 7.7 19 4 19"},null,-1)]))}const sa=z({name:"mdi-chart-bell-curve-cumulative",render:ta}),aa={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function la(f,t){return c(),k("svg",aa,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M9 14H2v2h7v3l4-4l-4-4zm6-1v-3h7V8h-7V5l-4 4z"},null,-1)]))}const oa=z({name:"mdi-compare-horizontal",render:la}),na={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ra(f,t){return c(),k("svg",na,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M17 16.88c.56 0 1 .44 1 1s-.44 1-1 1s-1-.45-1-1s.44-1 1-1m0-3c2.73 0 5.06 1.66 6 4c-.94 2.34-3.27 4-6 4s-5.06-1.66-6-4c.94-2.34 3.27-4 6-4m0 1.5a2.5 2.5 0 0 0 0 5a2.5 2.5 0 0 0 0-5M18 3H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5.42c-.16-.32-.3-.66-.42-1c.12-.34.26-.68.42-1H4v-4h6v2.97c.55-.86 1.23-1.6 2-2.21V13h1.15c1.16-.64 2.47-1 3.85-1c1.06 0 2.07.21 3 .59V5c0-1.1-.9-2-2-2m-8 8H4V7h6zm8 0h-6V7h6z"},null,-1)]))}const ia=z({name:"mdi-table-eye",render:ra}),ca={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function da(f,t){return c(),k("svg",ca,t[0]||(t[0]=[u("path",{fill:"currentColor",d:"M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48q1.18-1.53 3.08-1.95q.58-2.02 2.14-3.4Q8.95 4.38 11 4.08v8.07L9.4 10.6L8 12l4 4l4-4l-1.4-1.4l-1.6 1.55V4.08q2.58.35 4.29 2.31T19 11q1.73.2 2.86 1.5q1.14 1.28 1.14 3q0 1.88-1.31 3.19T18.5 20Z"},null,-1)]))}const ua=z({name:"mdi-cloud-download",render:da}),ma={class:"flex flex-col items-stretch"},fa={class:"ms-2 divide-y border-x border-surface-500 rounded-sm border-y divide-solid divide-surface-500"},_a=["onClick"],pa={class:"flex"},ka=M({__name:"BacktestResultSelect",props:{backtestHistory:{required:!0,type:Object},selectedBacktestResultKey:{required:!1,default:"",type:String},canUseModify:{required:!1,default:!1,type:Boolean}},emits:["selectionChange","removeResult","updateResult"],setup(f,{emit:t}){const l=t,p=a=>{l("selectionChange",a)};function r(a,i){i.metadata.editing=!i.metadata.editing,i.metadata.filename&&l("updateResult",{run_id:a,notes:i.metadata.notes??"",filename:i.metadata.filename,strategy:i.metadata.strategyName})}return(a,i)=>{const o=Ve,n=Ye,d=F,g=me,_=Je,y=Vt;return c(),k("div",ma,[i[0]||(i[0]=u("h3",{class:"font-bold text-2xl"},"Available results:",-1)),u("ul",fa,[(c(!0),k(S,null,U(Object.entries(f.backtestHistory),([v,w])=>(c(),k("li",{key:v,button:"",class:Y([{"bg-primary dark:border-primary text-primary-contrast":v===f.selectedBacktestResultKey},"flex justify-between items-center py-1 px-1"]),onClick:T=>p(v)},[w.metadata.editing?b("",!0):(c(),k(S,{key:0},[s(o,{"backtest-result":w,"can-use-modify":f.canUseModify},null,8,["backtest-result","can-use-modify"]),u("div",pa,[f.canUseModify?(c(),B(d,{key:0,class:"flex-nowrap",size:"small",severity:"secondary",title:"Modify result notes.",onClick:G(T=>w.metadata.editing=!w.metadata.editing,["stop"])},{icon:m(()=>[s(n)]),_:2},1032,["onClick"])):b("",!0),s(d,{size:"small",class:"flex-nowrap",severity:"secondary",title:"Delete this Result from UI.",onClick:G(T=>l("removeResult",v),["stop"])},{icon:m(()=>[s(g)]),_:2},1032,["onClick"])])],64)),w.metadata.editing?(c(),k(S,{key:1},[s(_,{modelValue:w.metadata.notes,"onUpdate:modelValue":T=>w.metadata.notes=T,placeholder:"notes",size:"small"},null,8,["modelValue","onUpdate:modelValue"]),s(d,{size:"small",title:"Confirm",onClick:G(T=>r(v,w),["stop"])},{icon:m(()=>[s(y)]),_:2},1032,["onClick"])],64)):b("",!0)],10,_a))),128))])])}}}),ba={class:"flex flex-row pt-1 me-1 relative",style:{height:"calc(100vh - 60px)"}},va={key:0,class:"me-3 flex flex-col fixed",style:{"max-height":"calc(100vh - 60px)"}},ya={class:"flex flex-col w-full"},ga={key:0},ha={class:"w-full"},Ba=M({__name:"BacktestingView",setup(f){const t=H(),l=Se(),p=V(()=>t.activeBot.backtestHistory?Object.keys(t.activeBot.backtestHistory).length!==0:!1),r=V(()=>t.activeBot.backtestHistory?Object.keys(t.activeBot.backtestHistory).length>1:!1),a=V(()=>{try{return t.activeBot.selectedBacktestResult.timeframe}catch{return""}}),i=A(!1),o=A("run"),n=A(null),d=()=>{l.strategy=t.activeBot.selectedBacktestResult.strategy_name,t.activeBot.getStrategy(l.strategy),l.selectedTimeframe=t.activeBot.selectedBacktestResult.timeframe,l.selectedDetailTimeframe=t.activeBot.selectedBacktestResult.timeframe_detail||"",l.timerange=t.activeBot.selectedBacktestResult.timerange};return se(()=>t.activeBot.selectedBacktestResultKey,()=>{d()}),J(()=>t.activeBot.getState()),se(()=>t.activeBot.backtestRunning,()=>{t.activeBot.backtestRunning===!0?n.value=window.setInterval(t.activeBot.pollBacktest,1e3):n.value&&(clearInterval(n.value),n.value=null)}),(g,_)=>{const y=ne,v=Te,w=F,T=ka,h=ua,q=ot,R=et,O=ia,X=oa,ee=sa,C=Xs,I=lt,L=Qs,j=tt,Me=js,qe=Ms,Ae=gs,Pe=ds,Le=as,De=nt,ze=rt;return c(),k("div",ba,[u("div",{class:Y(["flex md:flex-row h-full w-16",{"w-96!":e(i)}])},[e(o)!=="visualize"?(c(),k("div",va,[s(w,{class:"self-start","aria-label":"Close",size:"small",severity:"secondary",variant:"outlined",onClick:_[0]||(_[0]=P=>i.value=!e(i))},{default:m(()=>[e(i)?b("",!0):(c(),B(y,{key:0,width:"24",height:"24"})),e(i)?(c(),B(v,{key:1,width:"24",height:"24"})):b("",!0)]),_:1}),s(Z,{name:"fade"},{default:m(()=>[e(i)?(c(),B(T,{key:0,"backtest-history":e(t).activeBot.backtestHistory,"selected-backtest-result-key":e(t).activeBot.selectedBacktestResultKey,"can-use-modify":e(t).activeBot.botFeatures.backtestSetNotes,onSelectionChange:e(t).activeBot.setBacktestResultKey,onRemoveResult:e(t).activeBot.removeBacktestResultFromMemory,onUpdateResult:e(t).activeBot.saveBacktestResultMetadata},null,8,["backtest-history","selected-backtest-result-key","can-use-modify","onSelectionChange","onRemoveResult","onUpdateResult"])):b("",!0)]),_:1})])):b("",!0)],2),u("div",ya,[_[13]||(_[13]=u("h2",{class:"ms-5 text-3xl font-bold"},"Backtesting",-1)),e(t).activeBot.canRunBacktest?b("",!0):(c(),k("p",ga," Bot must be in webserver mode to enable Backtesting. ")),u("div",ha,[s(ze,{value:"run",lazy:""},{default:m(()=>[s(I,null,{default:m(()=>[e(t).activeBot.botFeatures.backtestHistory?(c(),B(q,{key:0,modelValue:e(o),"onUpdate:modelValue":_[1]||(_[1]=P=>D(o)?o.value=P:null),class:"flex items-center",value:"historicResults",disabled:!e(t).activeBot.canRunBacktest},{default:m(()=>[s(h,{class:"me-2"}),_[7]||(_[7]=$("Load Results"))]),_:1,__:[7]},8,["modelValue","disabled"])):b("",!0),s(q,{modelValue:e(o),"onUpdate:modelValue":_[2]||(_[2]=P=>D(o)?o.value=P:null),class:"flex items-center",value:"run",disabled:!e(t).activeBot.canRunBacktest},{default:m(()=>[s(R,{class:"me-2"}),_[8]||(_[8]=$("Run backtest"))]),_:1,__:[8]},8,["modelValue","disabled"]),s(q,{id:"bt-analyze-btn",modelValue:e(o),"onUpdate:modelValue":_[3]||(_[3]=P=>D(o)?o.value=P:null),class:"flex items-center",value:"results",disabled:!e(p)},{default:m(()=>[s(O,{class:"me-2"}),_[9]||(_[9]=$("Analyze result"))]),_:1,__:[9]},8,["modelValue","disabled"]),e(r)?(c(),B(q,{key:1,modelValue:e(o),"onUpdate:modelValue":_[4]||(_[4]=P=>D(o)?o.value=P:null),class:"flex items-center",value:"compare-results",disabled:!e(r)},{default:m(()=>[s(X,{class:"me-2"}),_[10]||(_[10]=$("Compare results"))]),_:1,__:[10]},8,["modelValue","disabled"])):b("",!0),s(q,{modelValue:e(o),"onUpdate:modelValue":_[5]||(_[5]=P=>D(o)?o.value=P:null),class:"flex items-center",value:"visualize-summary",disabled:!e(p)},{default:m(()=>[s(ee,{class:"me-2"}),_[11]||(_[11]=$("Visualize summary"))]),_:1,__:[11]},8,["modelValue","disabled"]),s(q,{modelValue:e(o),"onUpdate:modelValue":_[6]||(_[6]=P=>D(o)?o.value=P:null),class:"flex items-center",value:"visualize",disabled:!e(p)},{default:m(()=>[s(C,{class:"me-2"}),_[12]||(_[12]=$("Visualize result"))]),_:1,__:[12]},8,["modelValue","disabled"])]),_:1}),s(De,null,{default:m(()=>[s(j,{value:"historicResults"},{default:m(()=>[s(L)]),_:1}),s(j,{value:"run"},{default:m(()=>[s(Me)]),_:1}),s(j,{value:"results"},{default:m(()=>[e(p)?(c(),B(qe,{key:0,"backtest-result":e(t).activeBot.selectedBacktestResult,class:"flex-fill"},null,8,["backtest-result"])):b("",!0)]),_:1}),s(j,{value:"compare-results"},{default:m(()=>[e(r)?(c(),B(Ae,{key:0,"backtest-results":e(t).activeBot.backtestHistory,class:"flex-fill"},null,8,["backtest-results"])):b("",!0)]),_:1}),s(j,{value:"visualize-summary"},{default:m(()=>[e(p)?(c(),B(Pe,{key:0,trades:e(t).activeBot.selectedBacktestResult.trades,class:"flex-fill"},null,8,["trades"])):b("",!0)]),_:1}),s(j,{value:"visualize",l:""},{default:m(()=>[s(Le,{timeframe:e(a),strategy:e(l).strategy,timerange:e(l).timerange,"backtest-result":e(t).activeBot.selectedBacktestResult,"freqai-model":e(l).freqAI.enabled?e(l).freqAI.model:void 0},null,8,["timeframe","strategy","timerange","backtest-result","freqai-model"])]),_:1})]),_:1})]),_:1}),Xe(u("small",{class:"text-end bt-running-label"},"Backtest running: "+x(e(t).activeBot.backtestStep)+" "+x(("formatPercent"in g?g.formatPercent:e(E))(e(t).activeBot.backtestProgress,2)),513),[[st,e(t).activeBot.backtestRunning]])])])])}}}),Ga=N(Ba,[["__scopeId","data-v-097ca2dd"]]);export{Ga as default};
//# sourceMappingURL=BacktestingView-BPiU1GE8.js.map
