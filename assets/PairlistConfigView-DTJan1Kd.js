import{_ as te}from"./content-copy-BFTpfONv.js";import{_ as ve}from"./check-circle-DcBkCQMq.js";import{d as F,c5 as be,c as x,a as r,e as d,f as t,q as k,y as v,t as N,aY as oe,a8 as ne,P as xe,s as W,$ as se,V as Ce,u as ae,r as C,W as K,X as Q,p as T,Y as le,c6 as I,b$ as ye,H as Z,b as p,_ as ie,a6 as ke,x as R,h as y,F as A,v as D,a1 as re,a9 as ue,i as ce,g as Y,j as q,m as de,o as he,c7 as we,B as me}from"./index-BoH2X4lE.js";import{s as Ve}from"./index-RC2r1XTr.js";import{_ as $e,a as Se}from"./chevron-up-2Hfgm4Ko.js";import{_ as Be,u as ee,m as Pe}from"./useSortable--OsEPDiX.js";import{s as Ee}from"./index-BdcaoksP.js";import{s as Ie,a as Ne,_ as Ue,b as ze}from"./index-6JvTfbEk.js";import{_ as Te}from"./ExchangeSelect.vue_vue_type_script_setup_true_lang-D5NH5zO_.js";import"./plus-box-outline-CTP-ap11.js";import"./index-Cw_wDOQ2.js";import"./check-BvUZzYk1.js";var V=(u=>(u.string="string",u.number="number",u.boolean="boolean",u.option="option",u.list="list",u))(V||{});const Fe={class:"relative group copy-container"},Me={key:0,class:"text-sm"},Oe={class:"text-start border rounded-sm border-surface-500 p-2 m-0 bg-surface-50 dark:bg-surface-900 overflow-auto"},Re=F({__name:"CopyableTextfield",props:{content:{type:[String,Array],required:!0},isValid:{type:Boolean,default:!0}},setup(u){const{copy:n,isSupported:e,copied:s}=be();return(g,m)=>{const f=ve,i=te;return r(),x("div",Fe,[d("div",{class:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity hover:cursor-pointer flex dark:bg-surface-700 bg-surface-200 p-1 rounded-sm items-center justify-center flex-row",onClick:m[0]||(m[0]=o=>t(n)(typeof u.content=="string"?u.content:JSON.stringify(u.content)))},[t(s)?(r(),x("span",Me,"Copied!")):k("",!0),t(e)&&t(s)?(r(),v(f,{key:1})):k("",!0),!t(s)&&t(e)&&u.isValid?(r(),v(i,{key:2})):k("",!0)]),d("pre",Oe,[d("code",null,N(u.content),1)])])}}}),Ae={class:"pb-1 flex flex-row text-start"},De={class:"w-2/5"},je={class:"flex flex-col w-full"},He={class:"text-muted text-sm text-surface-500"},Ge=F({__name:"PairlistConfigParameter",props:oe({param:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const n=ne(u,"modelValue");return(e,s)=>{const g=W,m=se,f=xe("BFormSelect"),i=$e;return r(),x("div",Ae,[d("label",De,N(e.param.description),1),d("div",je,[e.param.type===t(V).string||e.param.type===t(V).number?(r(),v(g,{key:0,modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=o=>n.value=o),size:"small"},null,8,["modelValue"])):k("",!0),e.param.type===t(V).boolean?(r(),v(m,{key:1,modelValue:n.value,"onUpdate:modelValue":s[1]||(s[1]=o=>n.value=o)},null,8,["modelValue"])):k("",!0),e.param.type===t(V).option?(r(),v(f,{key:2,modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=o=>n.value=o),options:e.param.options},null,8,["modelValue","options"])):k("",!0),e.param.type===t(V).list?(r(),v(i,{key:3,modelValue:n.value,"onUpdate:modelValue":s[3]||(s[3]=o=>n.value=o)},null,8,["modelValue"])):k("",!0),d("span",He,N(e.param.help),1)])])}}}),j=Ce("pairlistConfig",()=>{const u=ae(),n=C(!1),e=C(),s=C(u.activeBot?.stakeCurrency??"USDT"),g=C([]),m=C(!1),f=C({exchange:u.activeBot?.botState.exchange??"",trade_mode:{trading_mode:u.activeBot?.botState.trading_mode??K.SPOT,margin_mode:u.activeBot?.botState.trading_mode===K.FUTURES?Q.ISOLATED:Q.NONE}}),i=C(_()),o=C([]),c=C(""),$=T(()=>!!i.value.pairlists[0]?.is_pairlist_generator),P=T(()=>$.value&&i.value.pairlists.length>0),S=T(()=>JSON.stringify(X(),null,2)),w=a=>o.value.findIndex(l=>l.name===a)>-1;function h(a,l){a=structuredClone(I(a)),a.showParameters=!1,a.id||(a.id=Date.now().toString(36)+Math.random().toString(36).substring(2));for(const b in a.params)a.params[b].value=ye(a.params[b].default)?a.params[b].default:"";i.value.pairlists.splice(l,0,a)}function B(a){i.value.pairlists.splice(a,1)}function U(a=""){const l=o.value.findIndex(b=>b.name===i.value.name);i.value.name=a,l>-1?o.value[l]=structuredClone(I(i.value)):o.value.push(structuredClone(I(i.value)))}function O(a){const l=_({name:a});o.value.push(l),i.value=structuredClone(l)}function H(a=""){const l=_({name:a,pairlists:I(i.value.pairlists),blacklist:I(i.value.blacklist)});o.value.push(l),i.value=structuredClone(l)}function G(){const a=o.value.findIndex(l=>l.name===i.value.name);a>-1&&(o.value.splice(a,1),M(o.value.length>0?o.value[0].name:"default"))}function M(a){const l=o.value.find(b=>a===b.name);l?i.value=structuredClone(I(l)):O(a)}function _({name:a="",pairlists:l=[],blacklist:b=[]}={}){return{name:a,pairlists:l,blacklist:b}}function z(){i.value.blacklist.push("")}function J(a){i.value.blacklist.splice(a,1)}function pe(a){const l=o.value.find(b=>b.name===a);l&&(i.value.blacklist=structuredClone(I(l.blacklist)))}async function fe(){const a=ge();n.value=!0;try{const{job_id:l}=await u.activeBot.evaluatePairlist(a);console.log("jobId",l),e.value=window.setInterval(async()=>{if(!(await u.activeBot.getBackgroundJobStatus(l)).running){clearInterval(e.value);const E=await u.activeBot.getPairlistEvalResult(l);n.value=!1,E.status==="success"?g.value=E.result.whitelist:E.error&&(Z(E.error,"error"),n.value=!1)}},1e3)}catch{Z("Evaluation failed","error"),n.value=!1}}function _e(a,l){return a===V.number?Number(l):a===V.boolean?!!l:a===V.list?l:String(l)}function ge(){const l={pairlists:X(),stake_currency:s.value,blacklist:i.value.blacklist};return m.value&&(console.log("setting custom exchange props"),l.exchange=f.value.exchange,l.trading_mode=f.value.trade_mode.trading_mode,l.margin_mode=f.value.trade_mode.margin_mode),l}function X(){const a=[];return i.value.pairlists.forEach(l=>{const b={method:l.name};for(const E in l.params){const L=l.params[E];L.value&&(b[E]=_e(L.type,L.value))}a.push(b)}),a}return le(()=>i.value,()=>{c.value=i.value.name},{deep:!0}),{evaluating:n,whitelist:g,config:i,configJSON:S,savedConfigs:o,configName:c,startPairlistEvaluation:fe,addToConfig:h,removeFromConfig:B,saveConfig:U,duplicateConfig:H,deleteConfig:G,newConfig:O,selectOrCreateConfig:M,addToBlacklist:z,removeFromBlacklist:J,duplicateBlacklist:pe,isSavedConfig:w,firstPairlistIsGenerator:$,pairlistValid:P,stakeCurrency:s,customExchange:m,selectedExchange:f}},{persist:{key:"ftPairlistConfig",pick:["savedConfigs","configName"]}}),Je={class:"shadow-sm rounded-sm border border-surface-300 dark:border-surface-700"},Le={class:"flex w-full text-start items-center bg-surface-200 dark:bg-surface-700 p-2 border-b border-surface-300 dark:border-surface-600"},qe={class:"flex grow items-center"},We={class:"font-bold"},Ye={class:"text-sm"},Xe={key:0,class:"p-2"},Ke=F({__name:"PairlistConfigItem",props:oe({index:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const n=j(),e=ne(u,"modelValue"),s=T(()=>Object.keys(e.value.params).length>0);function g(){s.value&&(e.value.showParameters=!e.value.showParameters)}return(m,f)=>{const i=Be,o=ie,c=ke,$=Se,P=Ge;return r(),x("div",Je,[d("div",Le,[d("div",qe,[p(i,{role:"button",class:"handle me-2 ms-2 shrink",width:"24",height:"24"}),d("div",{role:"button",class:"flex grow items-start flex-col user-select-none",onClick:g},[d("span",We,N(e.value.name),1),d("span",Ye,N(e.value.description),1)])]),p(o,{role:"button",width:"24",height:"24",class:"mx-2",onClick:f[0]||(f[0]=S=>t(n).removeFromConfig(m.index))}),e.value.showParameters?k("",!0):(r(),v(c,{key:0,class:R([t(s)&&!e.value.showParameters?"visible":"invisible","fs-4"]),role:"button",onClick:g},null,8,["class"])),e.value.showParameters?(r(),v($,{key:1,class:R([t(s)&&e.value.showParameters?"visible":"invisible","fs-4"]),role:"button",onClick:g},null,8,["class"])):k("",!0)]),p(re,null,{default:y(()=>[e.value.showParameters?(r(),x("div",Xe,[(r(!0),x(A,null,D(e.value.params,(S,w)=>(r(),v(P,{key:w,modelValue:e.value.params[w].value,"onUpdate:modelValue":h=>e.value.params[w].value=h,param:S},null,8,["modelValue","onUpdate:modelValue","param"]))),128))])):k("",!0)]),_:1})])}}}),Qe={class:"flex mb-4 items-center gap-2"},Ze=F({__name:"PairlistConfigBlacklist",setup(u){const n=j(),e=C(""),s=T(()=>n.savedConfigs.filter(g=>g.name!==n.config.name).map(g=>g.name));return(g,m)=>{const f=ue,i=te,o=Y,c=W,$=ie,P=Ne,S=Ie,w=Ee;return r(),v(w,{toggleable:"",header:"Blacklist",collapsed:""},{default:y(()=>[d("div",Qe,[m[3]||(m[3]=d("span",{class:"col-auto"},"Copy from:",-1)),p(f,{modelValue:t(e),"onUpdate:modelValue":m[0]||(m[0]=h=>ce(e)?e.value=h:null),size:"small",class:"grow",options:t(s)},null,8,["modelValue","options"]),p(o,{title:"Copy",size:"small",severity:"secondary",onClick:m[1]||(m[1]=h=>t(n).duplicateBlacklist(t(e)))},{icon:y(()=>[p(i)]),_:1})]),(r(!0),x(A,null,D(t(n).config.blacklist,(h,B)=>(r(),v(S,{key:B,class:"mb-2",size:"sm"},{default:y(()=>[p(c,{modelValue:t(n).config.blacklist[B],"onUpdate:modelValue":U=>t(n).config.blacklist[B]=U,size:"small"},null,8,["modelValue","onUpdate:modelValue"]),p(P,null,{default:y(()=>[p(o,{size:"small",severity:"secondary",onClick:U=>t(n).removeFromBlacklist(B)},{icon:y(()=>[p($)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128)),p(o,{size:"small",onClick:m[2]||(m[2]=h=>t(n).addToBlacklist())},{default:y(()=>m[4]||(m[4]=[q("Add")])),_:1,__:[4]})]),_:1})}}}),et={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function tt(u,n){return r(),x("svg",et,n[0]||(n[0]=[d("path",{fill:"currentColor",d:"M15 9H5V5h10m-3 14a3 3 0 0 1-3-3a3 3 0 0 1 3-3a3 3 0 0 1 3 3a3 3 0 0 1-3 3m5-16H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7z"},null,-1)]))}const ot=de({name:"mdi-content-save",render:tt}),nt={class:"flex flex-col sm:flex-row mb-2 gap-2"},st={key:1},at=F({__name:"PairlistConfigActions",setup(u){const n=j();return(e,s)=>{const g=ot,m=Y,f=ue,i=ze;return r(),x("div",nt,[p(m,{title:"Save configuration",size:"small",severity:"primary",onClick:s[0]||(s[0]=o=>t(n).saveConfig(t(n).config.name))},{default:y(()=>[p(g)]),_:1}),p(Ue,{modelValue:t(n).config.name,"onUpdate:modelValue":s[3]||(s[3]=o=>t(n).config.name=o),"editable-name":"config","allow-add":!0,"allow-duplicate":!0,"allow-edit":!0,class:"flex grow",onDelete:t(n).deleteConfig,onDuplicate:s[4]||(s[4]=(o,c)=>t(n).duplicateConfig(c)),onNew:s[5]||(s[5]=o=>t(n).newConfig(o)),onRename:s[6]||(s[6]=(o,c)=>t(n).saveConfig(c))},{default:y(()=>[p(f,{modelValue:t(n).configName,"onUpdate:modelValue":[s[1]||(s[1]=o=>t(n).configName=o),s[2]||(s[2]=o=>t(n).selectOrCreateConfig(o))],size:"small",class:"w-full text-start",options:t(n).savedConfigs.map(o=>o.name)},null,8,["modelValue","options"])]),_:1},8,["modelValue","onDelete"]),p(m,{title:"Evaluate pairlist",disabled:t(n).evaluating||!t(n).pairlistValid,severity:"primary",class:"px-5",size:"small",onClick:s[7]||(s[7]=o=>t(n).startPairlistEvaluation())},{default:y(()=>[t(n).evaluating?(r(),v(i,{key:0,class:"h-5 w-5"})):(r(),x("span",st,"Evaluate"))]),_:1},8,["disabled"])])}}}),lt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function it(u,n){return r(),x("svg",lt,n[0]||(n[0]=[d("path",{fill:"currentColor",d:"m17 12l-5 5v-3H8v-4h4V7zM3 19V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2m2 0h14V5H5z"},null,-1)]))}const rt=de({name:"mdi-arrow-right-bold-box-outline",render:it}),ut={class:"flex px-3 mb-3 gap-3 flex-col lg:flex-row"},ct={class:"flex grow items-start flex-col"},dt={class:"font-bold"},mt={class:"text-sm text-muted-color"},pt={class:"flex flex-col grow"},ft={class:"border rounded-sm border-surface-500 p-2 mb-2"},_t={class:"flex items-center gap-2 my-2"},gt={class:"mb-2 border rounded-sm border-surface-500 p-2 text-start"},vt={class:"flex flex-col w-full lg:w-3/12"},bt={class:"relative overflow-auto"},xt=F({__name:"PairlistConfigurator",setup(u){const n=ae(),e=j(),s=C([]),g=C(null),m=C(null),f=C("Config"),i=T(()=>e.config.pairlists.length==0);return ee(m,s.value,{group:{name:"configurator",pull:"clone",put:!1},sort:!1,filter:".no-drag",dragClass:"dragging"}),ee(g,e.config.pairlists,{handle:".handle",group:"configurator",onUpdate:async o=>{Pe(e.config.pairlists,o.oldIndex,o.newIndex)},onAdd:o=>{const c=s.value[o.oldIndex];e.addToConfig(c,o.newIndex),o.clone.replaceWith(o.item),o.clone.remove()}}),he(async()=>{s.value=(await n.activeBot.getPairlists()).pairlists.sort((o,c)=>o.is_pairlist_generator===c.is_pairlist_generator?o.name.localeCompare(c.name):o.is_pairlist_generator?-1:1),e.selectOrCreateConfig(e.isSavedConfig(e.configName)?e.configName:"default")}),le(()=>e.whitelist,()=>{f.value="Results"}),(o,c)=>{const $=rt,P=Y,S=at,w=W,h=se,B=Te,U=Ze,O=we,H=Ke,G=Ve,M=Re;return r(),x("div",ut,[d("ul",{ref_key:"availablePairlistsEl",ref:m,class:"divide-y border-x border-surface-500 rounded-sm border-y divide-solid divide-surface-500"},[(r(!0),x(A,null,D(t(s),_=>(r(),x("li",{key:_.name,class:R([{"no-drag text-gray-500 hover:cursor-default":t(e).config.pairlists.length==0&&!_.is_pairlist_generator},"pairlist flex text-start items-center py-2 px-3 hover:cursor-grab"])},[d("div",ct,[d("span",dt,N(_.name),1),d("span",mt,N(_.description),1)]),p(P,{severity:"secondary",class:"dark:text-white",variant:"text",disabled:t(e).config.pairlists.length==0&&!_.is_pairlist_generator,onClick:z=>t(e).addToConfig(_,t(e).config.pairlists.length)},{icon:y(()=>[p($)]),_:2},1032,["disabled","onClick"])],2))),128))],512),d("div",pt,[p(S),d("div",ft,[d("div",_t,[c[4]||(c[4]=d("span",{class:"col-auto"},"Stake currency: ",-1)),p(w,{modelValue:t(e).stakeCurrency,"onUpdate:modelValue":c[0]||(c[0]=_=>t(e).stakeCurrency=_),size:"small"},null,8,["modelValue"])]),d("div",gt,[p(h,{modelValue:t(e).customExchange,"onUpdate:modelValue":c[1]||(c[1]=_=>t(e).customExchange=_),class:"mb-2"},{default:y(()=>c[5]||(c[5]=[q(" Custom Exchange ")])),_:1,__:[5]},8,["modelValue"]),p(re,{name:"fade"},{default:y(()=>[t(e).customExchange?(r(),v(B,{key:0,modelValue:t(e).selectedExchange,"onUpdate:modelValue":c[2]||(c[2]=_=>t(e).selectedExchange=_)},null,8,["modelValue"])):k("",!0)]),_:1})])]),p(U),t(e).config.pairlists.length>0&&!t(e).firstPairlistIsGenerator?(r(),v(O,{key:0,class:"my-2",severity:"warn"},{default:y(()=>c[6]||(c[6]=[q(" First entry in the pairlist must be a Generating pairlist, like StaticPairList or VolumePairList. ")])),_:1,__:[6]})):k("",!0),d("div",{ref_key:"pairlistConfigsEl",ref:g,class:R(["flex flex-col grow relative border rounded-sm border-surface-500 p-1 gap-2",{empty:t(i)}])},[(r(!0),x(A,null,D(t(e).config.pairlists,(_,z)=>(r(),v(H,{key:_.id,modelValue:t(e).config.pairlists[z],"onUpdate:modelValue":J=>t(e).config.pairlists[z]=J,index:z,onRemove:t(e).removeFromConfig},null,8,["modelValue","onUpdate:modelValue","index","onRemove"]))),128))],2)]),d("div",vt,[p(G,{modelValue:t(f),"onUpdate:modelValue":c[3]||(c[3]=_=>ce(f)?f.value=_:null),class:"mb-2",size:"small","allow-empty":!1,"option-label":"value","option-value":"value",options:[{value:"Config"},{value:"Results",disabled:t(e).whitelist.length===0}],"option-disabled":"disabled"},null,8,["modelValue","options"]),d("div",bt,[t(f)==="Config"?(r(),v(M,{key:0,class:"lg:a22bsolute w-full",content:t(e).configJSON,"is-valid":t(e).pairlistValid},null,8,["content","is-valid"])):k("",!0),t(f)==="Results"?(r(),v(M,{key:1,class:"lg:abs22olute w-full",content:t(e).whitelist},null,8,["content"])):k("",!0)])])])}}}),Ct=me(xt,[["__scopeId","data-v-47402f67"]]),yt={};function kt(u,n){const e=Ct;return r(),v(e,{class:"pt-4"})}const Tt=me(yt,[["render",kt]]);export{Tt as default};
//# sourceMappingURL=PairlistConfigView-DTJan1Kd.js.map
