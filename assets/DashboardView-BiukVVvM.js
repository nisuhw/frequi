import{a as q,b as F,_ as H}from"./TradesLogChart-BbmsowEL.js";import{c as J}from"./ftEchartsTransforms-b3ZfMeKX.js";import{b as Q,c as Y}from"./InfoBox.vue_vue_type_script_setup_true_lang-BQdv8uKA.js";import{d as j,u as G,j as f,l as C,a as _,f as e,h as r,b as a,e as b,k as y,c as V,X as Z,x as w,z as B,i as ee,b4 as te,G as oe,D as se,K as ae,r as re,M as k,b5 as L,o as le,O,N as A}from"./index-D29yCp72.js";import{s as ne,a as ie}from"./index-B4uYRZl6.js";import{_ as de}from"./DraggableContainer.vue_vue_type_script_setup_true_lang-f0K0XHyn.js";import{_ as ue}from"./PeriodBreakdown.vue_vue_type_script_setup_true_lang-BzUtSi6A.js";import"./installCanvasRenderer-CZoFrcfF.js";import"./chartZoom-HUt5osHp.js";import"./index-DkSGa2Ur.js";import"./index-9K5Hdp12.js";import"./index-D6BgFeKg.js";import"./index-DWzCY5qb.js";import"./index-B6fWYvM8.js";import"./index-DP7VWIk7.js";import"./index-i8dkdNPL.js";const ce={class:"flex justify-between flex-row w-full"},pe={class:"flex flex-row justify-between items-center"},fe={key:2},me={key:0},_e=["title"],ye={class:"text-sm"},be={key:0},he={class:"text-profit"},ge={class:"text-loss"},Ce=j({__name:"BotComparisonList",setup(I){const o=G(),h=f({get:()=>Object.values(o.botStores).every(d=>d.isSelected),set:d=>{for(const s of Object.values(o.botStores))s.isSelected=d}}),$=f(()=>{const d=[],s={botId:void 0,botName:"Summary",profitClosed:0,profitClosedRatio:void 0,profitOpen:0,profitOpenRatio:void 0,stakeCurrency:"USDT",wins:0,losses:0,balance:0,balanceAppendix:""};return Object.entries(o.allProfit).forEach(([l,n])=>{const c=o.botStores[l];if(!c)return;const p=o.allOpenTrades[l];if(!p)return;const g=p.reduce((i,u)=>i+u.stake_amount,0),t=p.reduce((i,u)=>i+(u.total_profit_ratio??u.profit_ratio??0)*u.stake_amount,0)/g,m=p.reduce((i,u)=>i+(u.total_profit_abs??u.profit_abs??0),0);d.push({botId:l,botName:c.uiBotName||c.botId,trades:`${o.allOpenTradeCount[l]} / ${o.allBotState[l]?.max_open_trades||"N/A"}`,profitClosed:n?.profit_closed_coin??0,profitClosedRatio:n?.profit_closed_ratio||0,stakeCurrency:o.allBotState[l]?.stake_currency||"",profitOpenRatio:t,profitOpen:m,wins:n?.winning_trades??0,losses:n?.losing_trades??0,balance:o.allBalance[l]?.total_bot??o.allBalance[l]?.total??0,stakeCurrencyDecimals:o.allBotState[l]?.stake_currency_decimals||3,isDryRun:o.allBotState[l]?.dry_run,isOnline:o.botStores[l]?.isBotOnline,balanceAppendix:o.allBotState[l]?.dry_run?"(dry)":""}),n?.profit_closed_coin!==void 0&&c.isSelected&&(s.profitClosed+=n.profit_closed_coin,s.profitOpen+=m,s.wins+=n.winning_trades,s.losses+=n.losing_trades,o.allSelectedBotsSameStake&&(s.balance+=o.allBalance[l]?.total_bot??o.allBalance[l]?.total??0,s.stakeCurrencyDecimals=o.allBotState[l]?.stake_currency_decimals||3,o.allSelectedBotsSameState?s.balanceAppendix=o.allBotState[l]?.dry_run?"(dry)":"(live)":s.balanceAppendix="(mixed dry and live)"),s.stakeCurrency=o.allBotState[l]?.stake_currency||s.stakeCurrency)}),d.push(s),d});return(d,s)=>{const l=te,n=Z,c=ie,p=Q,g=ne;return _(),C(g,{size:"small",value:e($)},{default:r(()=>[a(c,{field:"botName"},{header:r(()=>[b("div",ce,[s[5]||(s[5]=b("b",null,"Bot Name",-1)),a(l,{class:"items-center text-slate-200 bg-slate-800 cursor-pointer",severity:"contrast",title:"Click to select all bots",onClick:s[0]||(s[0]=t=>e(o).toggleBotsByState("all"))},{default:r(()=>[...s[4]||(s[4]=[w("All",-1)])]),_:1})])]),body:r(({data:t,field:m})=>[b("div",pe,[b("div",null,[t.botId&&e(o).botCount>1?(_(),C(n,{key:0,modelValue:e(o).botStores[t.botId].isSelected,"onUpdate:modelValue":i=>e(o).botStores[t.botId].isSelected=i,title:"Show this bot in Dashboard"},{default:r(()=>[w(B(t[m]),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])):y("",!0),!t.botId&&e(o).botCount>1?(_(),C(n,{key:1,modelValue:e(h),"onUpdate:modelValue":s[1]||(s[1]=i=>ee(h)?h.value=i:null),title:"Toggle all bots",class:"font-bold"},{default:r(()=>[w(B(t[m]),1)]),_:2},1032,["modelValue"])):y("",!0),e(o).botCount<=1?(_(),V("span",fe,B(t[m]),1)):y("",!0)]),t.isOnline&&t.isDryRun?(_(),C(l,{key:0,class:"items-center bg-green-800 text-slate-200 cursor-pointer",severity:"success",title:"Click to select all dry run bots",onClick:s[2]||(s[2]=i=>e(o).toggleBotsByState("dry"))},{default:r(()=>[...s[6]||(s[6]=[w("Dry",-1)])]),_:1})):y("",!0),t.isOnline&&!t.isDryRun?(_(),C(l,{key:1,class:"items-center cursor-pointer",severity:"warning",title:"Click to select all live bots",onClick:s[3]||(s[3]=i=>e(o).toggleBotsByState("live"))},{default:r(()=>[...s[7]||(s[7]=[w("Live",-1)])]),_:1})):y("",!0),t.isOnline===!1?(_(),C(l,{key:2,class:"items-center",severity:"secondary"},{default:r(()=>[...s[8]||(s[8]=[w("Offline",-1)])]),_:1})):y("",!0)])]),_:1}),a(c,{field:"trades",header:"Trades"}),a(c,{header:"Open Profit"},{body:r(({data:t})=>[t.profitOpen&&t.botId!="Summary"?(_(),C(p,{key:0,"profit-ratio":t.profitOpenRatio,"profit-abs":t.profitOpen,"profit-desc":`Total Profit (Open and realized) ${("formatPercent"in d?d.formatPercent:e(oe))(t.profitOpenRatio??0)}`,"stake-currency":t.stakeCurrency},null,8,["profit-ratio","profit-abs","profit-desc","stake-currency"])):y("",!0)]),_:1}),a(c,{header:"Closed Profit"},{body:r(({data:t})=>[t.profitClosed&&t.botId!="Summary"?(_(),C(p,{key:0,"profit-ratio":t.profitClosedRatio,"profit-abs":t.profitClosed,"stake-currency":t.stakeCurrency},null,8,["profit-ratio","profit-abs","stake-currency"])):y("",!0)]),_:1}),a(c,{field:"balance",header:"Balance"},{body:r(({data:t})=>[t.balance?(_(),V("div",me,[b("span",{title:t.stakeCurrency},B(("formatPrice"in d?d.formatPrice:e(se))(t.balance??0,t.stakeCurrencyDecimals)),9,_e),b("span",ye,B(` ${t.stakeCurrency}${t.balanceAppendix}`),1)])):y("",!0)]),_:1}),a(c,{field:"winVsLoss",header:"W/L"},{body:r(({data:t})=>[t.losses!==void 0?(_(),V("div",be,[b("span",he,B(t.wins),1),s[9]||(s[9]=w(" / ",-1)),b("span",ge,B(t.losses),1)])):y("",!0)]),_:1})]),_:1},8,["value"])}}}),we={class:"flex justify-content-center"},ve={class:"flex justify-content-center"},Ie=j({__name:"DashboardView",setup(I){const o=G(),h=ae(),$=re("");function d(D){$.value=D}const s=f(()=>["","sm","md","lg","xl"].includes($.value)),l=f(()=>h.layoutLocked||!s.value),n=f(()=>s.value?h.dashboardLayout:[...h.getDashboardLayoutSm]);function c(D){s.value&&(console.log("newlayout",D),console.log("saving dashboard"),h.dashboardLayout=D)}const p=f(()=>k(n.value,L.dailyChart)),g=f(()=>k(n.value,L.botComparison)),t=f(()=>k(n.value,L.allOpenTrades)),m=f(()=>k(n.value,L.allClosedTrades)),i=f(()=>k(n.value,L.cumChartChart)),u=f(()=>k(n.value,L.profitDistributionChart)),T=f(()=>k(n.value,L.tradesLogChart)),U=f(()=>({sm:h.getDashboardLayoutSm}));return le(async()=>{o.allGetDaily({timescale:30}),o.activeBot.getOpenTrades(),o.activeBot.getProfit()}),(D,P)=>{const z=ue,v=de,S=A("GridItem"),E=Ce,R=Y,N=J,M=q,K=F,W=H,X=A("GridLayout");return _(),C(X,{class:"h-full w-full",style:{padding:"1px"},"row-height":50,layout:e(n),"vertical-compact":!1,margin:[2,2],"responsive-layouts":e(U),"is-resizable":!e(l),"is-draggable":!e(l),responsive:!0,"prevent-collision":!0,cols:{lg:12,md:12,sm:12,xs:4,xxs:2},"col-num":12,onLayoutUpdated:c,"onUpdate:breakpoint":d},{default:r(({gridItemProps:x})=>[a(S,O(x,{i:e(p).i,x:e(p).x,y:e(p).y,w:e(p).w,h:e(p).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:r(()=>[a(v,{header:`Profit over time ${e(o).botCount>1?"combined":""}`},{default:r(()=>[a(z,{"multi-bot-view":""})]),_:1},8,["header"])]),_:1},16,["i","x","y","w","h"]),a(S,O(x,{i:e(g).i,x:e(g).x,y:e(g).y,w:e(g).w,h:e(g).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:r(()=>[a(v,{header:"Bot comparison"},{default:r(()=>[a(E)]),_:1})]),_:1},16,["i","x","y","w","h"]),a(S,O(x,{i:e(t).i,x:e(t).x,y:e(t).y,w:e(t).w,h:e(t).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:r(()=>[a(v,null,{header:r(()=>[b("div",we,[P[0]||(P[0]=w(" Open Trades ",-1)),a(R,{class:"ms-2",hint:"Open trades of all selected bots. Click on a trade to go to the trade page for that trade/bot."})])]),default:r(()=>[a(N,{"active-trades":"",trades:e(o).allOpenTradesSelectedBots,"multi-bot-view":""},null,8,["trades"])]),_:1})]),_:1},16,["i","x","y","w","h"]),a(S,O(x,{i:e(i).i,x:e(i).x,y:e(i).y,w:e(i).w,h:e(i).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:r(()=>[a(v,{header:"Cumulative Profit"},{default:r(()=>[a(M,{trades:e(o).allTradesSelectedBots,"open-trades":e(o).allOpenTradesSelectedBots,"show-title":!1},null,8,["trades","open-trades"])]),_:1})]),_:1},16,["i","x","y","w","h"]),a(S,O(x,{i:e(m).i,x:e(m).x,y:e(m).y,w:e(m).w,h:e(m).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:r(()=>[a(v,null,{header:r(()=>[b("div",ve,[P[1]||(P[1]=w(" Closed Trades ",-1)),a(R,{class:"ms-2",hint:"Closed trades for all selected bots. Click on a trade to go to the trade page for that trade/bot."})])]),default:r(()=>[a(N,{"active-trades":!1,"show-filter":"",trades:e(o).allClosedTradesSelectedBots,"multi-bot-view":""},null,8,["trades"])]),_:1})]),_:1},16,["i","x","y","w","h"]),a(S,O(x,{i:e(u).i,x:e(u).x,y:e(u).y,w:e(u).w,h:e(u).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:r(()=>[a(v,{header:"Profit Distribution"},{default:r(()=>[a(K,{trades:e(o).allTradesSelectedBots,"show-title":!1},null,8,["trades"])]),_:1})]),_:1},16,["i","x","y","w","h"]),a(S,O(x,{i:e(T).i,x:e(T).x,y:e(T).y,w:e(T).w,h:e(T).h,"min-w":3,"min-h":4,"drag-allow-from":".drag-header"}),{default:r(()=>[a(v,{header:"Trades Log"},{default:r(()=>[a(W,{trades:e(o).allTradesSelectedBots,"show-title":!1},null,8,["trades"])]),_:1})]),_:1},16,["i","x","y","w","h"])]),_:1},8,["layout","responsive-layouts","is-resizable","is-draggable"])}}});export{Ie as default};
//# sourceMappingURL=DashboardView-BiukVVvM.js.map
