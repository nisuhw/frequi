{"version":3,"file":"HomeView-DERIV_to.js","sources":["../../src/components/BotRename.vue","../../src/components/BotList.vue","../../src/views/HomeView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport type { BotDescriptor } from '@/types';\nconst props = defineProps<{\n  bot: BotDescriptor;\n}>();\nconst emit = defineEmits<{ cancelled: []; saved: [] }>();\n\nconst botStore = useBotStore();\nconst newName = ref<string>('');\n\nonMounted(() => {\n  newName.value = props.bot.botName;\n});\n\nconst save = () => {\n  botStore.updateBot(props.bot.botId, {\n    botName: newName.value,\n  });\n\n  emit('saved');\n};\n</script>\n\n<template>\n  <form class=\"flex w-full gap-2\" @submit.prevent=\"save\">\n    <InputText v-model=\"newName\" size=\"small\" class=\"w-full\" placeholder=\"Bot name\" autofocus />\n\n    <div class=\"flex gap-1\">\n      <Button type=\"submit\" size=\"small\" severity=\"secondary\" title=\"Save\" class=\"w-8 h-8 p-0!\">\n        <i-mdi-check />\n      </Button>\n\n      <Button\n        size=\"small\"\n        severity=\"secondary\"\n        title=\"Cancel\"\n        class=\"w-8 h-8 p-0!\"\n        @click=\"$emit('cancelled')\"\n      >\n        <i-mdi-close />\n      </Button>\n    </div>\n  </form>\n</template>\n","<script setup lang=\"ts\">\nimport LoginModal from '@/components/LoginModal.vue';\n\nimport type { AuthStorageWithBotId, BotDescriptor } from '@/types';\nimport { useSortable } from '@vueuse/integrations/useSortable';\nimport { useConfirm } from 'primevue/useconfirm';\n\ndefineProps<{\n  small?: boolean;\n}>();\n\nconst botStore = useBotStore();\n\nconst editingBots = ref<string[]>([]);\nconst loginModal = ref<typeof LoginModal>();\nconst sortContainer = ref<HTMLElement | null>(null);\nconst botListComp = computed<BotDescriptor[]>(() => {\n  //Convert to array\n  return botStore.availableBotsSorted;\n});\n\nuseSortable(sortContainer, botListComp, {\n  handle: '.handle',\n  onUpdate: (e) => {\n    const oldBotId = botListComp.value[e.oldIndex]?.botId;\n    const newBotId = botListComp.value[e.newIndex]?.botId;\n    if (oldBotId && newBotId) {\n      botStore.updateBot(oldBotId, { sortId: e.newIndex });\n      botStore.updateBot(newBotId, { sortId: e.oldIndex });\n    }\n  },\n});\n\nfunction editBot(botId: string) {\n  if (!editingBots.value.includes(botId)) {\n    editingBots.value.push(botId);\n  }\n}\n\nfunction editBotLogin(botId: string) {\n  const bot = botStore.botStores[botId];\n  if (!bot) {\n    console.error('Bot not found');\n    return;\n  }\n  const loginInfo: AuthStorageWithBotId = {\n    ...bot.getLoginInfo(),\n    botId,\n  };\n  loginModal.value?.openLoginModal(loginInfo);\n}\n\nfunction stopEditBot(botId: string) {\n  if (!editingBots.value.includes(botId)) {\n    return;\n  }\n\n  editingBots.value.splice(editingBots.value.indexOf(botId), 1);\n}\n\nconst confirm = useConfirm();\n\nfunction clearAll() {\n  confirm.require({\n    message: 'Are you sure you want to remove all bots? This cannot be undone.',\n    header: 'Clear All Bots',\n    icon: 'pi pi-exclamation-triangle',\n    rejectLabel: 'Cancel',\n    acceptLabel: 'Delete',\n    rejectClass: 'p-button-secondary p-button-outlined',\n    acceptClass: 'p-button-danger',\n    accept: () => {\n      botStore.clearAllBots();\n    },\n  });\n}\n\nconst { open: openFilePicker, onChange: onFileChange } = useFileDialog({\n  accept: '.json',\n  multiple: false,\n});\n\nonFileChange(async (files) => {\n  const file = files?.[0];\n  if (!file) return;\n\n  const reader = new FileReader();\n  reader.onload = async (e) => {\n    try {\n      const bots = JSON.parse(e.target?.result as string);\n      if (Array.isArray(bots)) {\n        let importedCount = 0;\n        for (const botData of bots) {\n          const botId = botStore.nextBotId;\n          const { login, initializeBot } = useLoginInfo(botId);\n\n          // Persist basic info immediately so it survives refresh\n          initializeBot({\n            botName: botData.botName,\n            apiUrl: botData.url,\n            username: botData.username,\n            accessToken: '',\n            refreshToken: '',\n            autoRefresh: true,\n            sortId: Object.keys(botStore.availableBots).length + 1,\n          });\n\n          // Always add the bot to the store first\n          const sortId = Object.keys(botStore.availableBots).length + 1;\n          botStore.addBot({\n            botName: botData.botName,\n            botId,\n            botUrl: botData.url,\n            sortId,\n          });\n          importedCount++;\n\n          // Attempt login in the background/separately\n          try {\n            await login({\n              botName: botData.botName,\n              url: botData.url,\n              username: botData.username,\n              password: botData.password,\n            });\n            console.log(`Successfully logged in bot: ${botData.botName}`);\n          } catch (err) {\n            console.error(`Failed to login bot ${botData.botName}`, err);\n          }\n        }\n        botStore.allRefreshFull();\n        showAlert(`Successfully imported ${importedCount} bots`, 'success');\n      }\n    } catch (err) {\n      showAlert(`Failed to parse JSON: ${err}`, 'error');\n      console.error('Failed to parse JSON', err);\n    }\n  };\n  reader.readAsText(file);\n});\n\nfunction triggerImport() {\n  openFilePicker();\n}\n</script>\n\n<template>\n  <div class=\"w-full mx-2\">\n    <h3 v-if=\"!small\" class=\"font-bold text-2xl mb-2\">Available bots</h3>\n    <ul\n      ref=\"sortContainer\"\n      class=\"flex flex-col divide-y border-x border-surface-500 rounded-sm border-y divide-solid divide-surface-500\"\n    >\n      <li\n        v-for=\"bot in botListComp\"\n        :key=\"bot.botId\"\n        :active=\"bot.botId === botStore.selectedBot\"\n        button\n        :title=\"`${bot.botId} - ${bot.botName} - ${bot.botUrl} - ${\n          botStore.botStores[bot.botId]?.isBotLoggedIn ? '' : 'Login info expired!'\n        }`\"\n        class=\"flex items-center p-2\"\n        :class=\"{\n          'bg-primary-100 dark:bg-primary-800 underline font-semibold':\n            bot.botId === botStore.selectedBot,\n        }\"\n        @click=\"botStore.selectBot(bot.botId)\"\n      >\n        <i-mdi-reorder-horizontal v-if=\"!small\" class=\"handle cursor-pointer me-2 fs-4\" />\n        <BotRename\n          v-if=\"editingBots.includes(bot.botId)\"\n          :bot=\"bot\"\n          @saved=\"stopEditBot(bot.botId)\"\n          @cancelled=\"stopEditBot(bot.botId)\"\n        />\n\n        <BotEntry\n          v-else\n          :bot=\"bot\"\n          :no-buttons=\"small\"\n          @edit=\"editBot(bot.botId)\"\n          @edit-login=\"editBotLogin(bot.botId)\"\n        />\n      </li>\n    </ul>\n    <div v-if=\"!small\" class=\"flex flex-col gap-2 mt-4\">\n      <div class=\"flex gap-2 justify-center\">\n        <LoginModal ref=\"loginModal\" login-text=\"Add new bot\" />\n        <Button label=\"Import Bots\" severity=\"info\" @click=\"triggerImport\">\n          <template #icon>\n            <i-mdi-upload />\n          </template>\n        </Button>\n        <Button label=\"Clear All\" severity=\"danger\" @click=\"clearAll\">\n          <template #icon>\n            <i-mdi-delete-sweep />\n          </template>\n        </Button>\n      </div>\n    </div>\n  </div>\n</template>\n","<template>\n  <div class=\"mt-5\">\n    <div class=\"flex justify-center\">\n      <BotList class=\"max-w-xl\" />\n    </div>\n    <Divider />\n    <div\n      title=\"Freqtrade logo\"\n      class=\"logo-svg my-5 mx-auto dark:bg-white bg-black sm:w-[250px] sm:h-[250px] w-[150px] h-[150px] transition-all duration-300\"\n    />\n    <h1 class=\"font-bold text-2xl sm:text-4xl mb-4 transition-all\">Welcome to the Freqtrade UI</h1>\n    <div>This page allows you to control your trading bot.</div>\n    <Divider />\n    <p class=\"mb-2\">\n      If you need any help, please refer to the\n      <a\n        class=\"text-primary underline cursor-pointer\"\n        href=\"https://www.freqtrade.io/en/latest/\"\n        target=\"_blank\"\n      >\n        Freqtrade Documentation\n      </a>\n      .\n    </p>\n\n    <p class=\"mb-5\">Have fun - <i>wishes you the Freqtrade team</i></p>\n  </div>\n</template>\n\n<style lang=\"css\" scoped>\n.logo-svg {\n  -webkit-mask: url(../assets/freqtrade-logo-mask.png) no-repeat center;\n  -webkit-mask-size: 240px 240px;\n  mask: url(../assets/freqtrade-logo-mask.png) no-repeat center;\n  mask-size: contain;\n}\n</style>\n"],"names":["props","__props","emit","__emit","botStore","useBotStore","newName","ref","onMounted","save","_createElementBlock","_createVNode","_component_InputText","_unref","$event","_createElementVNode","_hoisted_1","_component_Button","_component_i_mdi_check","$emit","_component_i_mdi_close","editingBots","loginModal","sortContainer","botListComp","computed","useSortable","e","oldBotId","newBotId","editBot","botId","editBotLogin","bot","loginInfo","stopEditBot","confirm","useConfirm","clearAll","openFilePicker","onFileChange","useFileDialog","files","file","reader","bots","importedCount","botData","login","initializeBot","useLoginInfo","sortId","err","showAlert","triggerImport","_openBlock","_hoisted_2","_Fragment","_renderList","_createBlock","_component_i_mdi_reorder_horizontal","_component_BotRename","_component_BotEntry","_hoisted_4","_hoisted_5","LoginModal","_component_i_mdi_upload","_component_i_mdi_delete_sweep","_component_BotList","_component_Divider","_cache"],"mappings":"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"}