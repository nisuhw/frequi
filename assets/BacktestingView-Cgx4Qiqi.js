import{I as L,c as p,a as r,e as d,$ as He,a0 as Ue,a1 as ie,a2 as Ne,O as Fe,d as M,u as z,r as A,j as V,V as te,b as s,f as e,i as K,h as f,F as S,m as I,z as x,k as b,g as H,x as R,n as Q,l as B,a3 as Oe,Z as W,t as U,o as Y,L as ae,a4 as je,G as F,D as Z,H as Ee,a5 as Ge,a6 as We,y as de,R as Ze,X as Ke,s as ue,v as Qe,a7 as Ye,a8 as re,w as j,B as me,J as Je,a9 as Xe,W as et,aa as tt,Y as st}from"./index-D29yCp72.js";import{_ as at,a as lt,b as ot,c as nt,d as it,s as rt}from"./index-CmUQcz1O.js";import{_ as le}from"./DraggableContainer.vue_vue_type_script_setup_true_lang-f0K0XHyn.js";import{c as fe,i as _e,f as ct,d as dt}from"./ftEchartsTransforms-b3ZfMeKX.js";import{_ as pe,a as ut,b as mt,c as ke}from"./InfoBox.vue_vue_type_script_setup_true_lang-BQdv8uKA.js";import{s as ft}from"./index-DP7VWIk7.js";import{_ as _t,s as pt}from"./CandleChartContainer.vue_vue_type_script_setup_true_lang-CdCmWOZD.js";import{_ as kt,a as bt,b as vt}from"./TradesLogChart-BbmsowEL.js";import{u as be,r as yt,s as ve,i as ye,a as ge,b as he,c as Be,d as xe}from"./installCanvasRenderer-CZoFrcfF.js";import{d as gt,e as ht,i as Bt,a as xt,b as Re,c as we,f as $e,g as Rt}from"./chartZoom-HUt5osHp.js";import{s as E,a as G}from"./index-B4uYRZl6.js";import{g as Ce,a as ce,b as wt}from"./backtestMetrics-DiKe12vH.js";import{s as $t}from"./index-9K5Hdp12.js";import{s as Ct}from"./index-DdoQYVm8.js";import{_ as Tt}from"./TimeRangeSelect.vue_vue_type_script_setup_true_lang-BN5-zynJ.js";import{s as Vt}from"./index-DkSGa2Ur.js";import{_ as St,a as Mt}from"./StrategySelect.vue_vue_type_script_setup_true_lang-DtRygdXd.js";import{_ as qt}from"./check-BvKfympZ.js";import"./index-D6BgFeKg.js";import"./index-DWzCY5qb.js";import"./index-BVqpLxLT.js";import"./plus-box-outline-B84fhGS0.js";import"./index-B6fWYvM8.js";import"./index-i8dkdNPL.js";const At={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Pt(o,t){return r(),p("svg",At,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6z"},null,-1)])])}const oe=L({name:"mdi-chevron-right",render:Pt});var Lt=`
    .p-radiobutton-group {
        display: inline-flex;
    }
`,Dt={root:"p-radiobutton-group p-component"},It=He.extend({name:"radiobuttongroup",style:Lt,classes:Dt}),zt={name:"BaseRadioButtonGroup",extends:Ue,style:It,provide:function(){return{$pcRadioButtonGroup:this,$parentInstance:this}}},Te={name:"RadioButtonGroup",extends:zt,inheritAttrs:!1,data:function(){return{groupName:this.name}},watch:{name:function(t){this.groupName=t||ie("radiobutton-group-")}},mounted:function(){this.groupName=this.groupName||ie("radiobutton-group-")}};function Ht(o,t,l,_,u,a){return r(),p("div",Fe({class:o.cx("root")},o.ptmi("root")),[Ne(o.$slots,"default")],16)}Te.render=Ht;const Ut={class:"flex justify-center"},Nt=["for"],Ft={class:"divide-y divide-surface-300 dark:divide-surface-700 divide-solid border-x border-y rounded-sm border-surface-300 dark:border-surface-700"},Ot=["title","onClick"],jt={class:"flex"},Et={class:"flex flex-col"},Gt={key:0},Wt={key:0},Zt={class:"px-3 m-0 list-disc list-inside"},Kt={key:0},Qt=M({__name:"TradeListNav",props:{trades:{},backtestMode:{type:Boolean,default:!1}},emits:["trade-select"],setup(o,{emit:t}){const l=o,_=t,u=z(),a=A({}),i=A(!0),m=A("openDate"),n=[{text:"Open date",value:"openDate"},{text:"Profit %",value:"profit"}],c=y=>{a.value=y,_("trade-select",y)},g=V(()=>{const y=m.value==="profit"?"profit_ratio":"open_timestamp";return i.value?l.trades.slice().sort((v,w)=>(w[y]??0)-(v[y]??0)):l.trades.slice().sort((v,w)=>(v[y]??0)-(w[y]??0))}),k=A(g.value.map(()=>!1));return te(()=>u.activeBot.selectedPair,()=>{k.value=g.value.map(()=>!1)}),(y,v)=>{const w=ft,T=Te,h=H,q=pe,$=ut,O=mt,J=oe,X=Oe;return r(),p("div",null,[d("div",Ut,[v[2]||(v[2]=d("span",{class:"me-2"},"Sort by:",-1)),s(T,{modelValue:e(m),"onUpdate:modelValue":v[0]||(v[0]=C=>K(m)?m.value=C:null),options:n,name:"radio-options"},{default:f(()=>[(r(),p(S,null,I(n,C=>d("div",{key:C.value,class:"flex items-center"},[s(w,{id:`id-${C.value}`,value:C.value},null,8,["id","value"]),d("label",{for:`id-${C.value}`},x(C.text),9,Nt)])),64))]),_:1},8,["modelValue"])]),d("ul",Ft,[s(h,{severity:"secondary",variant:"text",class:"w-full flex flex-wrap justify-center items-center",title:"Trade Navigation",onClick:v[1]||(v[1]=C=>i.value=!e(i))},{default:f(()=>[R("Trade Navigation "+x(e(i)?"↓":"↑"),1)]),_:1}),(r(!0),p(S,null,I(e(g),(C,D)=>(r(),p("li",{key:C.open_timestamp,class:Q(["flex flex-col py-1 px-1 items-stretch",{"bg-primary-100 dark:bg-primary-800 text-primary-contrast":C.open_timestamp===e(a).open_timestamp}]),title:`${C.pair}`,onClick:P=>c(C)},[d("div",jt,[d("div",Et,[d("div",null,[e(u).activeBot.botState.trading_mode!=="spot"?(r(),p("span",Gt,x(C.is_short?"S-":"L-"),1)):b("",!0),s(q,{date:C.open_timestamp},null,8,["date"])]),s($,{trade:C,class:"my-1"},null,8,["trade"]),o.backtestMode?(r(),B(O,{key:0,"profit-ratio":C.profit_ratio,"stake-currency":e(u).activeBot.stakeCurrency},null,8,["profit-ratio","stake-currency"])):b("",!0)]),s(h,{size:"small",class:"ms-auto mt-auto",variant:"outlined",severity:"secondary",onClick:P=>e(k)[D]=!e(k)[D]},{default:f(()=>[e(k)[D]?b("",!0):(r(),B(J,{key:0,width:"24",height:"24"})),e(k)[D]?(r(),B(X,{key:1,width:"24",height:"24"})):b("",!0)]),_:2},1032,["onClick"])]),s(W,null,{default:f(()=>[e(k)[D]?(r(),p("div",Wt,[d("ul",Zt,[(r(!0),p(S,null,I(C.orders?.filter(P=>P.order_filled_timestamp!==null),P=>(r(),p("li",{key:P.order_timestamp},x(P.ft_order_side)+" "+x(P.amount)+" at "+x(P.safe_price),1))),128))])])):b("",!0)]),_:2},1024)],10,Ot))),128)),o.trades.length===0?(r(),p("div",Kt,"No trades to show...")):b("",!0)])])}}}),Yt=U(Qt,[["__scopeId","data-v-51d4fa9e"]]),Jt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Xt(o,t){return r(),p("svg",Jt,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M15.41 16.58L10.83 12l4.58-4.59L14 6l-6 6l6 6z"},null,-1)])])}const Ve=L({name:"mdi-chevron-left",render:Xt}),es={class:"flex flex-row mb-1 items-center"},ts={class:"me-2"},ss={class:"grow"},as={class:"text-end"},ls={class:"text-center flex flex-row h-full items-stretch overflow-x-clip"},os=M({__name:"BacktestResultChart",props:{timeframe:{},strategy:{},freqaiModel:{},timerange:{},backtestResult:{}},setup(o){const t=o,l=z(),_=A({right:!0,left:!0}),u=A();function a(m){u.value={startValue:m.open_timestamp,endValue:m.close_timestamp}}function i(m,n){l.activeBot.getPairHistory({pair:m,timeframe:t.timeframe,timerange:t.timerange,strategy:t.strategy,freqaimodel:t.freqaiModel,columns:n,margin_mode:t.backtestResult.margin_mode,trading_mode:t.backtestResult.trading_mode})}return Y(()=>{if(!l.activeBot.selectedPair&&t.backtestResult.pairlist.length>0){const[m]=t.backtestResult.pairlist;m&&(l.activeBot.selectedPair=m)}}),(m,n)=>{const c=oe,g=Ve,k=H,y=at,v=_t,w=Yt,T=fe,h=le;return r(),p("div",null,[d("div",es,[d("div",ts,[s(k,{"aria-label":"Close",title:"Pair Navigation",severity:"secondary",variant:"outlined",size:"small",onClick:n[0]||(n[0]=q=>e(_).left=!e(_).left)},{default:f(()=>[e(_).left?b("",!0):(r(),B(c,{key:0,width:"24",height:"24"})),e(_).left?(r(),B(g,{key:1,width:"24",height:"24"})):b("",!0)]),_:1})]),d("span",ss,[n[2]||(n[2]=R(" Graph will always show the latest values for the selected strategy. ",-1)),n[3]||(n[3]=d("br",null,null,-1)),R(" Timerange: "+x(o.timerange)+" - "+x(o.strategy),1)]),d("div",as,[s(k,{"aria-label":"Close",variant:"outlined",title:"Trade Navigation",size:"small",severity:"secondary",onClick:n[1]||(n[1]=q=>e(_).right=!e(_).right)},{default:f(()=>[e(_).right?(r(),B(c,{key:0,width:"24",height:"24"})):b("",!0),e(_).right?b("",!0):(r(),B(g,{key:1,width:"24",height:"24"}))]),_:1})])]),d("div",ls,[s(W,{name:"fadeleft"},{default:f(()=>[e(_).left?(r(),B(y,{key:0,class:"overflow-y-auto overflow-x-hidden",style:{"max-height":"calc(100vh - 200px)"},pairlist:o.backtestResult.pairlist,trades:o.backtestResult.trades,"starting-balance":o.backtestResult.starting_balance,"sort-method":"profit","backtest-mode":!0},null,8,["pairlist","trades","starting-balance"])):b("",!0)]),_:1}),s(v,{"available-pairs":o.backtestResult.pairlist,"historic-view":"","reload-data-on-switch":"",timeframe:o.timeframe,timerange:o.timerange,strategy:o.strategy,trades:o.backtestResult.trades,class:"flex-1 candle-chart-container px-0 h-full align-self-stretch min-w-0 overflow-y-auto","slider-position":e(u),"freqai-model":o.freqaiModel,onRefreshData:i},null,8,["available-pairs","timeframe","timerange","strategy","trades","slider-position","freqai-model"]),s(W,{name:"fade"},{default:f(()=>[e(_).right?(r(),B(w,{key:0,class:"overflow-y-auto overflow-x-visible min-w-56",style:{"max-height":"calc(100vh - 200px)"},trades:o.backtestResult.trades.filter(q=>q.pair===e(l).activeBot.selectedPair),onTradeSelect:a},null,8,["trades"])):b("",!0)]),_:1})]),s(h,{header:"Single trades",class:"row mt-2 w-full"},{default:f(()=>[s(T,{class:"row trade-history mt-2 w-full",trades:o.backtestResult.trades,"show-filter":!0},null,8,["trades"])]),_:1})])}}}),ns=U(os,[["__scopeId","data-v-7d5a26e6"]]),ee="Market change %",is=M({__name:"MarketChangeChart",props:{marketChangeData:{},showTitle:{type:Boolean,default:!0}},setup(o){be([Bt,xt,ye,Re,ge,we,he,Be,xe,$e,_e]);const t=o,l=ae(),_=A(null);yt(ct.multiple);const u=V(()=>{if(!t.marketChangeData)return{};const a=t.marketChangeData.columns.findIndex(m=>m==="__date_ts"),i=t.marketChangeData.columns.findIndex(m=>m==="rel_mean");return{title:{text:"Market change %",left:"center",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:[{source:t.marketChangeData.data},{transform:{type:"ft:multiple",config:{dimension:i,factor:100,mode:"array"}}}],tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},grid:{...ht},legend:{data:[ee],right:"5%",top:0,selectedMode:!1},xAxis:[{type:"time",axisLine:{onZero:!1},axisTick:{show:!0},axisLabel:{show:!0},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"}],yAxis:[{type:"value",name:ee,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:35}],dataZoom:[{type:"inside",start:0,end:100},{bottom:10,start:0,end:100,...gt}],series:[{type:"line",name:ee,showSymbol:!1,color:l.chartTheme==="dark"?"#c2c2c2":"black",datasetIndex:1,encode:{x:a,y:i}}]}});return(a,i)=>o.marketChangeData?.data?(r(),B(e(ve),{key:0,ref_key:"marketChangeChart",ref:_,option:e(u),theme:e(l).chartTheme,autoresize:""},null,8,["option","theme"])):b("",!0)}}),rs=U(is,[["__scopeId","data-v-f7c31da9"]]),cs=M({__name:"TradeDurationChart",props:{trades:{},showTitle:{type:Boolean,default:!0}},setup(o){const t=o,l=ae();be([ge,Be,xe,Re,he,we,_e,dt,ye,$e,Rt]);const _=V(()=>t.trades.map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),u=V(()=>t.trades.filter(n=>(n.profit_ratio??0)>0).map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),a=V(()=>t.trades.filter(n=>(n.profit_ratio??0)<=0).map(n=>(n.close_timestamp-n.open_timestamp)/(60*1e3))),i=V(()=>({title:{text:"Trades durations",left:"center",show:t.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:[{id:"allTrades",source:[_.value,u.value,a.value]},{id:"allTradesBoxplot",fromDatasetId:"allTrades",transform:{type:"boxplot",config:{itemNameFormatter:n=>{if(n.value===0)return"All trades";if(n.value===1)return"Winning trades";if(n.value===2)return"Losing trades"}}}},{id:"outlier",fromDatasetIndex:1,fromTransformResult:1}],xAxis:{type:"category",show:!0},yAxis:[{type:"value",name:"Trade duration",splitArea:{show:!0},axisLabel:{formatter:m}}],tooltip:{formatter:n=>{if(n.seriesType==="boxplot"){const c=n.data;return`
            <div>${n.name}</div>
            <div>Min: ${m(c[1])}</div>
            <div>Q1: ${m(c[2])}</div>
            <div>Median: ${m(c[3])}</div>
            <div>Q3: ${m(c[4])}</div>
            <div>Max: ${m(c[5])}</div>
          `}return""}},visualMap:[{type:"piecewise",show:!1,dimension:0,pieces:[{min:0,max:0,label:"All Trades",color:"#5470c6"},{min:1,max:1,label:"Winning Trades",color:"#12bb7b"},{min:2,max:2,label:"Losing Trades",color:"#ef5350"}]}],series:[{name:"Trade durations",type:"boxplot",datasetId:"allTradesBoxplot",colorBy:"data"},{name:"outlier",type:"scatter",datasetId:"outlier"}]}));function m(n){if(n>=60){const c=Math.floor(n/60),g=Math.floor(n%60);return`${c}h ${g}m`}return`${Math.floor(n)}m`}return(n,c)=>o.trades.length>0?(r(),B(e(ve),{key:0,option:e(i),autoresize:"",theme:e(l).chartTheme},null,8,["option","theme"])):b("",!0)}}),ds=U(cs,[["__scopeId","data-v-36605ead"]]),us={class:"text-center flex-fill flex flex-col h-full gap-1"},ms=M({__name:"BacktestGraphs",props:{trades:{}},setup(o){const t=z(),{state:l}=je(()=>t.activeBot.getBacktestMarketChange(),null);return(_,u)=>{const a=kt,i=bt,m=rs,n=vt;return r(),p("div",us,[s(a,{trades:o.trades,class:"grow chart-equal-height"},null,8,["trades"]),s(ds,{class:"grow chart-equal-height",trades:o.trades,"show-title":!0},null,8,["trades"]),s(i,{trades:o.trades,class:"grow chart-equal-height","show-title":!0},null,8,["trades"]),e(l)?(r(),B(m,{key:0,"market-change-data":e(l),class:"grow chart-equal-height"},null,8,["market-change-data"])):b("",!0),s(n,{class:"grow chart-equal-height",trades:o.trades,"show-title":!0},null,8,["trades"])])}}}),fs=U(ms,[["__scopeId","data-v-da387d59"]]),_s={class:"flex flex-col me-2 text-start"},ps={class:"font-bold"},ks={class:"text-sm"},bs={key:0,class:"text-sm",style:{"white-space":"pre-wrap"}},Se=M({__name:"BacktestResultSelectEntry",props:{backtestResult:{},selectedBacktestResultKey:{default:""},canUseModify:{type:Boolean,default:!1}},setup(o){return(t,l)=>(r(),p("div",_s,[d("div",ps,x(o.backtestResult.metadata.strategyName)+" - "+x(o.backtestResult.strategy.timeframe),1),d("div",ks," TradeCount: "+x(o.backtestResult.strategy.total_trades)+" - Profit: "+x(("formatPercent"in t?t.formatPercent:e(F))(o.backtestResult.strategy.profit_total)),1),o.canUseModify?(r(),p("div",bs,x(o.backtestResult.metadata.notes),1)):b("",!0)]))}});function se(o,t){return Object.entries(o).reduce((_,[u,a])=>(a.forEach(i=>{const m=Object.entries(i)[0];if(!m)return;const[n,c]=m,g=_.find(k=>k[t]===n);g?g[u]=c:_.push({[t]:n,[u]:c})}),_),[])}const vs={class:"px-0 mw-full"},ys={class:"flex flex-col text-start ms-0 me-2 gap-2"},gs={class:"flex flex-col flex-xl-row"},hs={class:"px-0 xl:px-0 pt-2 xl:pt-0 xl:ps-1 flex-fill"},Bs={key:1},xs=M({__name:"BacktestResultComparison",props:{backtestResults:{}},setup(o){const t=o,l=V(()=>{const u={};return Object.entries(t.backtestResults).forEach(([a,i])=>{const m=Ce(i.strategy);u[a]=m}),console.log(u),se(u,"metric")}),_=V(()=>{const u=[{key:"metric",label:"Metric"}];return Object.entries(t.backtestResults).forEach(([a,i])=>{u.push({key:a,label:i.metadata.strategyName})}),u});return(u,a)=>{const i=Se,m=G,n=E;return r(),p("div",vs,[a[0]||(a[0]=d("div",{class:"flex justify-center"},[d("h3",{class:"font-bold text-3xl"},"Backtest-result comparison")],-1)),d("div",ys,[d("div",gs,[d("div",hs,[s(n,{bordered:"",value:e(l),size:"small","show-gridlines":""},{default:f(()=>[(r(!0),p(S,null,I(e(_),c=>(r(),B(m,{key:c.key,field:c.key,label:c.label},{header:f(()=>[c.key&&o.backtestResults[c.key]?(r(),B(i,{key:0,"backtest-result":o.backtestResults[c.key]},null,8,["backtest-result"])):(r(),p("span",Bs,x(c.label),1))]),_:2},1032,["field","label"]))),128))]),_:1},8,["value"])])])])])}}}),Rs=M({__name:"BacktestResultPeriodBreakdown",props:{periodicBreakdown:{}},setup(o){const t=o,l=V(()=>{const u=[{value:"day",text:"Days"},{value:"week",text:"Weeks"},{value:"month",text:"Months"}];return t.periodicBreakdown.year&&u.push({value:"year",text:"Years"}),t.periodicBreakdown.weekday&&u.push({value:"weekday",text:"Weekday"}),u}),_=A("month");return(u,a)=>{const i=$t,m=G,n=E;return r(),p(S,null,[s(i,{modelValue:e(_),"onUpdate:modelValue":a[0]||(a[0]=c=>K(_)?_.value=c:null),options:e(l),size:"small","allow-empty":!1,class:"m-2","option-label":"text","option-value":"value"},null,8,["modelValue","options"]),s(n,{size:"small",stacked:"sm",value:o.periodicBreakdown[e(_)]},{default:f(()=>[s(m,{field:"date",header:"Date"}),s(m,{field:"trades",header:"Trades"},{body:f(({data:c,field:g})=>[R(x(c[g]??"N/A"),1)]),_:1}),s(m,{field:"profit_abs",header:"Total Profit",body:"formatPrice"in u?u.formatPrice:e(Z)},{body:f(({data:c,field:g})=>[R(x(("formatNumber"in u?u.formatNumber:e(Ee))(c[g],2)),1)]),_:1},8,["body"]),s(m,{field:"profit_factor",header:"Profit Factor"},{body:f(({data:c,field:g})=>[R(x(("formatPrice"in u?u.formatPrice:e(Z))(c[g],2)),1)]),_:1}),s(m,{field:"wins",header:"Wins"}),s(m,{field:"draws",header:"Draws"}),s(m,{field:"losses",header:"Losses"},{body:f(({data:c})=>[R(x(c.loses??c.losses??"N/A"),1)]),_:1}),s(m,{field:"wins",header:"Win Rate"},{body:f(({data:c})=>[R(x(("formatPercent"in u?u.formatPercent:e(F))(c.wins/(c.wins+c.draws+(c.loses??c.losses)),2)),1)]),_:1})]),_:1},8,["value"])],64)}}}),ws={class:"flex flex-row w-full justify-between items-center"},$s=M({__name:"BacktestResultTablePer",props:{title:{},results:{},stakeCurrency:{},stakeCurrencyDecimals:{},keyHeader:{default:""},keyHeaders:{default:()=>[]}},setup(o){const t=o,l=V(()=>t.results.map(i=>t.keyHeaders.length>0?{...i,key:typeof i.key=="string"?Array(t.keyHeaders.length).fill(i.key):i.key}:i)),_=V(()=>{const i=[];if(t.keyHeaders.length>0)for(const[m,n]of t.keyHeaders.entries())i.push({key:`key[${m}]`,label:n,formatter:(c,g)=>Array.isArray(c)?c[m]:c||g.exit_reason||"OTHER"});else i.push({key:"key",label:t.keyHeader,formatter:(m,n)=>m||n.exit_reason||"OTHER"});return i}),u=ae(),a=V(()=>ce.value.filter(i=>i.field!=="key"&&u.backtestAdditionalMetrics.includes(i.field)));return(i,m)=>{const n=Ct,c=G,g=E,k=le;return r(),B(k,null,{header:f(()=>[d("div",ws,[R(x(o.title)+" ",1),d("div",null,[m[1]||(m[1]=R(" Shown metrics: ",-1)),s(n,{id:"backtestMetrics",modelValue:e(u).backtestAdditionalMetrics,"onUpdate:modelValue":m[0]||(m[0]=y=>e(u).backtestAdditionalMetrics=y),options:"availableBacktestMetrics"in i?i.availableBacktestMetrics:e(ce),"option-label":"header","option-value":"field",size:"small"},null,8,["modelValue","options"])])])]),default:f(()=>[s(g,{size:"small",hover:"",stacked:"sm",value:e(l)},{default:f(()=>[(r(!0),p(S,null,I(e(_),y=>(r(),B(c,{key:y.key,field:y.key,header:y.label},{body:f(({data:v})=>[R(x(y.formatter(v.key,v)),1)]),_:2},1032,["field","header"]))),128)),s(c,{field:"trades",header:"Trades"}),s(c,{field:"profit_mean",header:"Avg Profit %"},{body:f(({data:y,field:v})=>[R(x(("formatPercent"in i?i.formatPercent:e(F))(y[v],2)),1)]),_:1}),s(c,{field:"profit_total_abs",header:`Tot Profit ${t.stakeCurrency}`},{body:f(({data:y,field:v})=>[R(x(("formatPrice"in i?i.formatPrice:e(Z))(y[v],t.stakeCurrencyDecimals)),1)]),_:1},8,["header"]),s(c,{field:"profit_total",header:"Tot Profit %"},{body:f(({data:y,field:v})=>[R(x(("formatPercent"in i?i.formatPercent:e(F))(y[v],2)),1)]),_:1}),s(c,{field:"wins",header:"Wins"}),s(c,{field:"draws",header:"Draws"}),s(c,{field:"losses",header:"Losses"}),(r(!0),p(S,null,I(e(a),y=>(r(),B(c,{key:y.field,field:y.field,header:y.header},{body:f(({data:v,field:w})=>[R(x(y.is_ratio?("formatPercent"in i?i.formatPercent:e(F))(v[w],2):("formatPrice"in i?i.formatPrice:e(Z))(v[w],2)),1)]),_:2},1032,["field","header"]))),128))]),_:1},8,["value"])]),_:1})}}}),Cs={class:"px-0 w-full"},Ts={class:"flex justify-center"},Vs={class:"font-bold text-2xl mb-2"},Ss={class:"flex flex-col text-start ms-0 me-2 gap-2"},Ms={class:"flex flex-col xl:flex-row"},qs={class:"px-0 px-xl-0 pe-xl-1 grow"},As={class:"px-0 xl:px-0 pt-2 xl:pt-0 xl:ps-1 grow"},Ps=M({__name:"BacktestResultAnalysis",props:{backtestResult:{}},setup(o){const t=o,l=V(()=>{const u=Ce(t.backtestResult);return se({value:u},"metric")}),_=V(()=>{const u=wt(t.backtestResult);return se({value:u},"setting")});return(u,a)=>{const i=G,m=E,n=le,c=$s,g=Rs,k=fe;return r(),p("div",Cs,[d("div",Ts,[d("h3",Vs," Backtest-result for "+x(o.backtestResult.strategy_name),1)]),d("div",Ss,[d("div",Ms,[d("div",qs,[s(n,{header:"Strategy settings"},{default:f(()=>[s(m,{size:"small",value:e(_)},{default:f(()=>[s(i,{field:"setting",header:"Setting"}),s(i,{field:"value",header:"Value"})]),_:1},8,["value"])]),_:1})]),d("div",As,[s(n,{header:"Metrics"},{default:f(()=>[s(m,{size:"small",borderless:"",value:e(l)},{default:f(()=>[s(i,{field:"metric",header:"Metric"}),s(i,{field:"value",header:"Value"})]),_:1},8,["value"])]),_:1})])]),s(c,{title:"Results per Enter tag",results:o.backtestResult.results_per_enter_tag,"stake-currency":o.backtestResult.stake_currency,"key-header":"Enter Tag","stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),s(c,{title:"Results per Exit reason",results:o.backtestResult.exit_reason_summary??[],"stake-currency":o.backtestResult.stake_currency,"key-header":"Exit Reason","stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),o.backtestResult.mix_tag_stats?(r(),B(c,{key:0,title:"Results Mixed Tag",results:o.backtestResult.mix_tag_stats??[],"stake-currency":o.backtestResult.stake_currency,"key-headers":["Enter Tag","Exit Tag"],"stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"])):b("",!0),s(c,{title:"Results per pair",results:o.backtestResult.results_per_pair,"stake-currency":o.backtestResult.stake_currency,"key-header":"Pair","stake-currency-decimals":o.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),o.backtestResult.periodic_breakdown?(r(),B(n,{key:1,header:"Periodic breakdown"},{default:f(()=>[s(g,{"periodic-breakdown":o.backtestResult.periodic_breakdown},null,8,["periodic-breakdown"])]),_:1})):b("",!0),s(n,{header:"Single trades"},{default:f(()=>[s(k,{trades:o.backtestResult.trades,"show-filter":!0,"stake-currency":o.backtestResult.stake_currency},null,8,["trades","stake-currency"])]),_:1})])])}}}),Ls={class:"w-full flex"},Ds={class:"ms-2"},Is=M({__name:"FreqaiModelSelect",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const t=Ge(o,"modelValue"),l=z();return Y(()=>{l.activeBot.freqaiModelList.length===0&&l.activeBot.getFreqAIModelList()}),(_,u)=>{const a=We,i=de,m=H;return r(),p("div",null,[d("div",Ls,[s(a,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=n=>t.value=n),options:e(l).activeBot.freqaiModelList,fluid:"",size:"small"},null,8,["modelValue","options"]),d("div",Ds,[s(m,{severity:"secondary",variant:"outlined",size:"small",onClick:e(l).activeBot.getFreqAIModelList},{icon:f(()=>[s(i)]),_:1},8,["onClick"])])])])}}}),Me=Ze("btStore",{state:()=>({strategy:"",selectedTimeframe:"",selectedDetailTimeframe:"",timerange:"",maxOpenTrades:null,stakeAmount:null,startingCapital:null,allowCache:!0,enableProtections:!1,stakeAmountUnlimited:!1,freqAI:{enabled:!1,model:"",identifier:""}}),getters:{canRunBacktest:o=>o.strategy!==""},actions:{}}),zs={class:"mb-2"},Hs=["disabled"],Us={for:"timeframe-detail-select",class:"flex justify-end items-center gap-2"},Ns={class:"flex items-center"},Fs={class:"flex basis-full"},Os={class:"flex justify-end items-center"},js={class:"flex flex-wrap md:flex-nowrap justify-between md:justify-center"},Es=M({__name:"BacktestRun",setup(o){const t=z(),l=Me();function _(){const u={strategy:l.strategy,timerange:l.timerange,enable_protections:l.enableProtections};if(l.maxOpenTrades&&(u.max_open_trades=l.maxOpenTrades),l.stakeAmountUnlimited)u.stake_amount="unlimited";else{const i=Number(l.stakeAmount);i&&(u.stake_amount=i.toString())}const a=Number(l.startingCapital);a&&(u.dry_run_wallet=a),l.selectedTimeframe&&(u.timeframe=l.selectedTimeframe),l.selectedDetailTimeframe&&(u.timeframe_detail=l.selectedDetailTimeframe),l.allowCache||(u.backtest_cache="none"),l.freqAI.enabled&&(u.freqaimodel=l.freqAI.model,l.freqAI.identifier!==""&&(u.freqai={identifier:l.freqAI.identifier})),t.activeBot.startBacktest(u)}return(u,a)=>{const i=St,m=Mt,n=ke,c=Vt,g=Ke,k=ue,y=Is,v=Qe,w=Tt,T=H;return r(),p(S,null,[d("div",zs,[a[13]||(a[13]=d("span",null,"Strategy",-1)),s(i,{modelValue:e(l).strategy,"onUpdate:modelValue":a[0]||(a[0]=h=>e(l).strategy=h)},null,8,["modelValue"])]),d("div",{class:"grid grid-cols-2 border border-surface-500 rounded-sm gap-y-2 gap-2 items-center p-1 pt-3",disabled:e(t).activeBot.backtestRunning},[a[20]||(a[20]=d("h3",{class:"font-bold mb-2 col-span-2 text-center"},"Backtesting parameters",-1)),a[21]||(a[21]=d("label",{for:"timeframe-select"},"Timeframe:",-1)),s(m,{id:"timeframe-select",modelValue:e(l).selectedTimeframe,"onUpdate:modelValue":a[1]||(a[1]=h=>e(l).selectedTimeframe=h),size:"small"},null,8,["modelValue"]),d("label",Us,[a[14]||(a[14]=R("Detail Timeframe: ",-1)),s(n,{hint:"Detail timeframe, to simulate intra-candle results. Not setting this will not use this functionality."})]),s(m,{id:"timeframe-detail-select",modelValue:e(l).selectedDetailTimeframe,"onUpdate:modelValue":a[2]||(a[2]=h=>e(l).selectedDetailTimeframe=h),size:"small","below-timeframe":e(l).selectedTimeframe},null,8,["modelValue","below-timeframe"]),a[22]||(a[22]=d("label",{for:"max-open-trades"},"Max open trades:",-1)),s(c,{id:"max-open-trades",modelValue:e(l).maxOpenTrades,"onUpdate:modelValue":a[3]||(a[3]=h=>e(l).maxOpenTrades=h),size:"small",placeholder:"Use strategy default",type:"number"},null,8,["modelValue"]),a[23]||(a[23]=d("label",{for:"starting-capital"},"Starting capital:",-1)),s(c,{id:"starting-capital",modelValue:e(l).startingCapital,"onUpdate:modelValue":a[4]||(a[4]=h=>e(l).startingCapital=h),size:"small",placeholder:"Use config default",type:"number",step:.001},null,8,["modelValue"]),a[24]||(a[24]=d("label",{for:"stake-amount-bool"},"Stake amount:",-1)),d("div",Ns,[d("div",Fs,[s(g,{id:"stake-amount-bool",modelValue:e(l).stakeAmountUnlimited,"onUpdate:modelValue":a[5]||(a[5]=h=>e(l).stakeAmountUnlimited=h)},{default:f(()=>[...a[15]||(a[15]=[R("Unlimited stake",-1)])]),_:1},8,["modelValue"])]),s(c,{id:"stake-amount",modelValue:e(l).stakeAmount,"onUpdate:modelValue":a[6]||(a[6]=h=>e(l).stakeAmount=h),placeholder:"Use strategy default",step:.01,size:"small",disabled:e(l).stakeAmountUnlimited},null,8,["modelValue","disabled"])]),a[25]||(a[25]=d("label",{for:"enable-protections"},"Enable Protections:",-1)),s(g,{id:"enable-protections",modelValue:e(l).enableProtections,"onUpdate:modelValue":a[7]||(a[7]=h=>e(l).enableProtections=h)},null,8,["modelValue"]),e(t).activeBot.botFeatures.backtestFreqAI?(r(),p(S,{key:0},[a[16]||(a[16]=d("label",{for:"enable-cache"},"Cache Backtest results:",-1)),s(g,{id:"enable-cache",modelValue:e(l).allowCache,"onUpdate:modelValue":a[8]||(a[8]=h=>e(l).allowCache=h)},null,8,["modelValue"])],64)):b("",!0),e(t).activeBot.botFeatures.backtestFreqAI?(r(),p(S,{key:1},[d("div",Os,[a[17]||(a[17]=d("span",{class:"me-2"},"Enable FreqAI:",-1)),s(n,{hint:"Assumes freqAI configuration is setup in the configuration, and the strategy is a freqAI strategy. Will fail if that's not the case."})]),s(g,{id:"enable-freqai",modelValue:e(l).freqAI.enabled,"onUpdate:modelValue":a[9]||(a[9]=h=>e(l).freqAI.enabled=h)},null,8,["modelValue"]),e(l).freqAI.enabled?(r(),p(S,{key:0},[a[18]||(a[18]=d("label",{for:"freqai-identifier"},"FreqAI identifier:",-1)),s(k,{id:"freqai-identifier",modelValue:e(l).freqAI.identifier,"onUpdate:modelValue":a[10]||(a[10]=h=>e(l).freqAI.identifier=h),placeholder:"Use config default",size:"small"},null,8,["modelValue"])],64)):b("",!0),e(l).freqAI.enabled?(r(),p(S,{key:1},[a[19]||(a[19]=d("label",{for:"freqai-model"},"FreqAI Model:",-1)),s(y,{id:"freqai-model",modelValue:e(l).freqAI.model,"onUpdate:modelValue":a[11]||(a[11]=h=>e(l).freqAI.model=h)},null,8,["modelValue"])],64)):b("",!0)],64)):b("",!0),s(v,{class:"col-span-2"}),s(w,{modelValue:e(l).timerange,"onUpdate:modelValue":a[12]||(a[12]=h=>e(l).timerange=h),class:"mx-auto mt-2 col-span-2"},null,8,["modelValue"])],8,Hs),a[30]||(a[30]=d("h3",{class:"mt-3 font-bold text-2xl"},"Backtesting summary",-1)),d("div",js,[s(T,{id:"start-backtest",severity:"primary",disabled:!e(l).canRunBacktest||e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,class:"mx-1",onClick:_},{default:f(()=>[...a[26]||(a[26]=[R(" Start backtest ",-1)])]),_:1},8,["disabled"]),s(T,{severity:"secondary",disabled:e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,class:"mx-1",onClick:e(t).activeBot.pollBacktest},{default:f(()=>[...a[27]||(a[27]=[R(" Load backtest result ",-1)])]),_:1},8,["disabled","onClick"]),s(T,{severity:"secondary",class:"mx-1",disabled:!e(t).activeBot.backtestRunning,onClick:e(t).activeBot.stopBacktest},{default:f(()=>[...a[28]||(a[28]=[R(" Stop Backtest ",-1)])]),_:1},8,["disabled","onClick"]),s(T,{severity:"secondary",class:"mx-1",disabled:e(t).activeBot.backtestRunning||!e(t).activeBot.canRunBacktest,onClick:e(t).activeBot.removeBacktest},{default:f(()=>[...a[29]||(a[29]=[R(" Reset Backtest ",-1)])]),_:1},8,["disabled","onClick"])])],64)}}}),Gs=U(Es,[["__scopeId","data-v-5f7698a9"]]),Ws={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Zs(o,t){return r(),p("svg",Ws,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M4 11v2h12l-5.5 5.5l1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5L16 11z"},null,-1)])])}const Ks=L({name:"mdi-arrow-right",render:Zs}),Qs={key:0,class:"flex align-center"},Ys={key:0,class:"ms-1"},Js={class:"flex items-center"},Xs=M({__name:"BacktestHistoryLoad",setup(o){const t=z(),l=A(),_=A(""),u=Ye(_,350,{maxWait:1e3});Y(()=>{t.activeBot.getBacktestHistory()});function a(n){const c={title:"Delete result",message:`Delete result ${n.filename} from disk?`,accept:()=>{t.activeBot.deleteBacktestHistoryResult(n)}};l.value?.show(c)}const i=V(()=>t.activeBot.backtestHistoryList.filter(n=>n.filename.toLowerCase().includes(u.value.toLowerCase())||n.strategy.toLowerCase().includes(u.value.toLowerCase())));function m(n){t.activeBot.getBacktestHistoryResult(n.data)}return(n,c)=>{const g=de,k=H,y=ue,v=G,w=pe,T=Ks,h=me,q=E;return r(),p(S,null,[d("div",null,[s(k,{class:"float-end",title:"Refresh","aria-label":"Refresh",variant:"outlined",severity:"secondary",onClick:e(t).activeBot.getBacktestHistory},{default:f(()=>[s(g)]),_:1},8,["onClick"]),c[1]||(c[1]=d("p",null," Load Historic results from disk. You can click on multiple results to load all of them into freqUI. ",-1)),e(t).activeBot.backtestHistoryList.length>0?(r(),p("div",Qs,[s(y,{id:"trade-filter",modelValue:e(_),"onUpdate:modelValue":c[0]||(c[0]=$=>K(_)?_.value=$:null),type:"text",size:"small",placeholder:"Filter results",title:"Filter results"},null,8,["modelValue"])])):b("",!0),e(t).activeBot.backtestHistoryList.length>0?(r(),B(q,{key:1,class:"mt-2",responsive:"",size:"small",scrollable:"","scroll-height":"50rem","virtual-scroller-options":{itemSize:46},"show-gridlines":"",value:e(i),onRowClick:m},{default:f(()=>[s(v,{field:"strategy",header:"Strategy2"}),s(v,{field:"timeframe",header:"Details"},{body:f(({data:$})=>[d("strong",null,x($.timeframe),1),$.backtest_start_ts&&$.backtest_end_ts?(r(),p("span",Ys,x(("timestampToTimeRangeString"in n?n.timestampToTimeRangeString:e(re))($.backtest_start_ts*1e3))+"-"+x(("timestampToTimeRangeString"in n?n.timestampToTimeRangeString:e(re))($.backtest_end_ts*1e3)),1)):b("",!0)]),_:1}),s(v,{field:"backtest_start_time",header:"Backtest Time"},{body:f(({data:$})=>[s(w,{date:$.backtest_start_time*1e3},null,8,["date"])]),_:1}),s(v,{field:"filename",header:"Filename"}),s(v,{field:"actions",header:"Actions"},{body:f(({data:$})=>[d("div",Js,[e(t).activeBot.botFeatures.backtestSetNotes?(r(),B(ke,{key:0,class:Q($.notes?"opacity-100":"opacity-0"),hint:$.notes??""},null,8,["class","hint"])):b("",!0),e(t).activeBot.botFeatures.backtestDelete?(r(),B(k,{key:1,class:"ms-1",size:"small",title:"Load this Result.",disabled:$.run_id in e(t).activeBot.backtestHistory,onClick:j(O=>e(t).activeBot.getBacktestHistoryResult($),["stop"])},{icon:f(()=>[s(T)]),_:1},8,["disabled","onClick"])):b("",!0),e(t).activeBot.botFeatures.backtestDelete?(r(),B(k,{key:2,class:"ms-1",size:"small",severity:"secondary",title:"Delete this Result.",disabled:$.run_id in e(t).activeBot.backtestHistory,onClick:j(O=>a($),["stop"])},{icon:f(()=>[s(h)]),_:1},8,["disabled","onClick"])):b("",!0)])]),_:1})]),_:1},8,["value"])):b("",!0)]),s(Je,{ref_key:"msgBox",ref:l},null,512)],64)}}}),ea={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ta(o,t){return r(),p("svg",ea,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M21 8c-1.5 0-2.3 1.4-1.9 2.5l-3.6 3.6c-.3-.1-.7-.1-1 0l-2.6-2.6c.4-1.1-.4-2.5-1.9-2.5c-1.4 0-2.3 1.4-1.9 2.5L3.5 16c-1.1-.3-2.5.5-2.5 2c0 1.1.9 2 2 2c1.4 0 2.3-1.4 1.9-2.5l4.5-4.6c.3.1.7.1 1 0l2.6 2.6c-.3 1 .5 2.5 2 2.5s2.3-1.4 1.9-2.5l3.6-3.6c1.1.3 2.5-.5 2.5-1.9c0-1.1-.9-2-2-2m-6 1l.9-2.1L18 6l-2.1-.9L15 3l-.9 2.1L12 6l2.1.9zM3.5 11L4 9l2-.5L4 8l-.5-2L3 8l-2 .5L3 9z"},null,-1)])])}const sa=L({name:"mdi-chart-timeline-variant-shimmer",render:ta}),aa={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function la(o,t){return r(),p("svg",aa,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M4 19v1h18v2H2V2h2v15c3 0 6-2 8.1-5.6c3-5 6.3-7.4 9.9-7.4v2c-2.8 0-5.5 2.1-8.1 6.5C11.3 16.6 7.7 19 4 19"},null,-1)])])}const oa=L({name:"mdi-chart-bell-curve-cumulative",render:la}),na={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ia(o,t){return r(),p("svg",na,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M9 14H2v2h7v3l4-4l-4-4zm6-1v-3h7V8h-7V5l-4 4z"},null,-1)])])}const ra=L({name:"mdi-compare-horizontal",render:ia}),ca={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function da(o,t){return r(),p("svg",ca,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M17 16.88c.56 0 1 .44 1 1s-.44 1-1 1s-1-.45-1-1s.44-1 1-1m0-3c2.73 0 5.06 1.66 6 4c-.94 2.34-3.27 4-6 4s-5.06-1.66-6-4c.94-2.34 3.27-4 6-4m0 1.5a2.5 2.5 0 0 0 0 5a2.5 2.5 0 0 0 0-5M18 3H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5.42c-.16-.32-.3-.66-.42-1c.12-.34.26-.68.42-1H4v-4h6v2.97c.55-.86 1.23-1.6 2-2.21V13h1.15c1.16-.64 2.47-1 3.85-1c1.06 0 2.07.21 3 .59V5c0-1.1-.9-2-2-2m-8 8H4V7h6zm8 0h-6V7h6z"},null,-1)])])}const ua=L({name:"mdi-table-eye",render:da}),ma={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function fa(o,t){return r(),p("svg",ma,[...t[0]||(t[0]=[d("path",{fill:"currentColor",d:"M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48q1.18-1.53 3.08-1.95q.58-2.02 2.14-3.4Q8.95 4.38 11 4.08v8.07L9.4 10.6L8 12l4 4l4-4l-1.4-1.4l-1.6 1.55V4.08q2.58.35 4.29 2.31T19 11q1.73.2 2.86 1.5q1.14 1.28 1.14 3q0 1.88-1.31 3.19T18.5 20Z"},null,-1)])])}const _a=L({name:"mdi-cloud-download",render:fa}),pa={class:"flex flex-col items-stretch"},ka={class:"ms-2 divide-y border-x border-surface-500 rounded-sm border-y divide-solid divide-surface-500"},ba=["onClick"],va={class:"flex"},ya=M({__name:"BacktestResultSelect",props:{backtestHistory:{},selectedBacktestResultKey:{default:""},canUseModify:{type:Boolean,default:!1}},emits:["selectionChange","removeResult","updateResult"],setup(o,{emit:t}){const l=t,_=a=>{l("selectionChange",a)};function u(a,i){i.metadata.editing=!i.metadata.editing,i.metadata.filename&&l("updateResult",{run_id:a,notes:i.metadata.notes??"",filename:i.metadata.filename,strategy:i.metadata.strategyName})}return(a,i)=>{const m=Se,n=Xe,c=H,g=me,k=pt,y=qt;return r(),p("div",pa,[i[0]||(i[0]=d("h3",{class:"font-bold text-2xl"},"Available results:",-1)),d("ul",ka,[(r(!0),p(S,null,I(Object.entries(o.backtestHistory),([v,w])=>(r(),p("li",{key:v,button:"",class:Q([{"bg-primary dark:border-primary text-primary-contrast":v===o.selectedBacktestResultKey},"flex justify-between items-center py-1 px-1"]),onClick:T=>_(v)},[w.metadata.editing?b("",!0):(r(),p(S,{key:0},[s(m,{"backtest-result":w,"can-use-modify":o.canUseModify},null,8,["backtest-result","can-use-modify"]),d("div",va,[o.canUseModify?(r(),B(c,{key:0,class:"flex-nowrap",size:"small",severity:"secondary",title:"Modify result notes.",onClick:j(T=>w.metadata.editing=!w.metadata.editing,["stop"])},{icon:f(()=>[s(n)]),_:1},8,["onClick"])):b("",!0),s(c,{size:"small",class:"flex-nowrap",severity:"secondary",title:"Delete this Result from UI.",onClick:j(T=>l("removeResult",v),["stop"])},{icon:f(()=>[s(g)]),_:1},8,["onClick"])])],64)),w.metadata.editing?(r(),p(S,{key:1},[s(k,{modelValue:w.metadata.notes,"onUpdate:modelValue":T=>w.metadata.notes=T,placeholder:"notes",size:"small"},null,8,["modelValue","onUpdate:modelValue"]),s(c,{size:"small",title:"Confirm",onClick:j(T=>u(v,w),["stop"])},{icon:f(()=>[s(y)]),_:1},8,["onClick"])],64)):b("",!0)],10,ba))),128))])])}}}),ga={class:"flex flex-row pt-1 me-1 relative",style:{height:"calc(100vh - 60px)"}},ha={class:"flex flex-col fixed"},Ba={class:"flex flex-col w-full"},xa={key:0},Ra={class:"w-full"},wa=M({__name:"BacktestingView",setup(o){const t=z(),l=Me(),_=V(()=>t.activeBot.backtestHistory?Object.keys(t.activeBot.backtestHistory).length!==0:!1),u=V(()=>t.activeBot.backtestHistory?Object.keys(t.activeBot.backtestHistory).length>1:!1),a=V(()=>t.activeBot.selectedBacktestResult?.timeframe??""),i=A(!1),m=A("run"),n=A(null);function c(){t.activeBot.selectedBacktestResult&&(l.strategy=t.activeBot.selectedBacktestResult.strategy_name,t.activeBot.getStrategy(l.strategy),l.selectedTimeframe=t.activeBot.selectedBacktestResult.timeframe,l.selectedDetailTimeframe=t.activeBot.selectedBacktestResult.timeframe_detail||"",l.timerange=t.activeBot.selectedBacktestResult.timerange,l.enableProtections=t.activeBot.selectedBacktestResult.enable_protections,l.freqAI.enabled=!!t.activeBot.selectedBacktestResult.freqaimodel,l.freqAI.model=t.activeBot.selectedBacktestResult.freqaimodel||"",l.freqAI.identifier=t.activeBot.selectedBacktestResult.freqai_identifier||"")}return te(()=>t.activeBot.selectedBacktestResultKey,()=>{c()}),Y(()=>t.activeBot.getState()),te(()=>t.activeBot.backtestRunning,()=>{t.activeBot.backtestRunning===!0?n.value=window.setInterval(t.activeBot.pollBacktest,1e3):n.value&&(clearInterval(n.value),n.value=null)}),(g,k)=>{const y=oe,v=Ve,w=H,T=ya,h=_a,q=ot,$=tt,O=ua,J=ra,X=oa,C=sa,D=lt,P=Xs,N=it,qe=Gs,Ae=Ps,Pe=xs,Le=fs,De=ns,Ie=nt,ze=rt;return r(),p("div",ga,[e(m)!=="visualize"?(r(),p("div",{key:0,class:Q(["flex md:flex-row h-full w-16 transition-all duration-200 shrink-0 me-1 border-r border-surface-200 dark:border-surface-900",{"w-78!":e(i)}])},[d("div",ha,[s(w,{class:"self-start","aria-label":"Close",size:"small",severity:"secondary",variant:"outlined",onClick:k[0]||(k[0]=ne=>i.value=!e(i))},{default:f(()=>[e(i)?b("",!0):(r(),B(y,{key:0,width:"24",height:"24"})),e(i)?(r(),B(v,{key:1,width:"24",height:"24"})):b("",!0)]),_:1}),s(W,{name:"fade"},{default:f(()=>[e(i)?(r(),B(T,{key:0,"backtest-history":e(t).activeBot.backtestHistory,"selected-backtest-result-key":e(t).activeBot.selectedBacktestResultKey,"can-use-modify":e(t).activeBot.botFeatures.backtestSetNotes,onSelectionChange:e(t).activeBot.setBacktestResultKey,onRemoveResult:e(t).activeBot.removeBacktestResultFromMemory,onUpdateResult:e(t).activeBot.saveBacktestResultMetadata},null,8,["backtest-history","selected-backtest-result-key","can-use-modify","onSelectionChange","onRemoveResult","onUpdateResult"])):b("",!0)]),_:1})])],2)):b("",!0),d("div",Ba,[k[8]||(k[8]=d("h2",{class:"ms-5 text-3xl font-bold"},"Backtesting",-1)),e(t).activeBot.canRunBacktest?b("",!0):(r(),p("p",xa," Bot must be in webserver mode to enable Backtesting. ")),d("div",Ra,[s(ze,{value:e(m),"onUpdate:value":k[1]||(k[1]=ne=>K(m)?m.value=ne:null),lazy:""},{default:f(()=>[s(D,null,{default:f(()=>[e(t).activeBot.botFeatures.backtestHistory?(r(),B(q,{key:0,class:"flex items-center",value:"historicResults",disabled:!e(t).activeBot.canRunBacktest},{default:f(()=>[s(h,{class:"me-2"}),k[2]||(k[2]=R("Load Results",-1))]),_:1},8,["disabled"])):b("",!0),s(q,{class:"flex items-center",value:"run",disabled:!e(t).activeBot.canRunBacktest},{default:f(()=>[s($,{class:"me-2"}),k[3]||(k[3]=R("Run backtest",-1))]),_:1},8,["disabled"]),s(q,{id:"bt-analyze-btn",class:"flex items-center",value:"results",disabled:!e(_)},{default:f(()=>[s(O,{class:"me-2"}),k[4]||(k[4]=R("Analyze result",-1))]),_:1},8,["disabled"]),e(u)?(r(),B(q,{key:1,class:"flex items-center",value:"compare-results",disabled:!e(u)},{default:f(()=>[s(J,{class:"me-2"}),k[5]||(k[5]=R("Compare results",-1))]),_:1},8,["disabled"])):b("",!0),s(q,{class:"flex items-center",value:"visualize-summary",disabled:!e(_)},{default:f(()=>[s(X,{class:"me-2"}),k[6]||(k[6]=R("Visualize summary",-1))]),_:1},8,["disabled"]),s(q,{class:"flex items-center",value:"visualize",disabled:!e(_)},{default:f(()=>[s(C,{class:"me-2"}),k[7]||(k[7]=R("Visualize result",-1))]),_:1},8,["disabled"])]),_:1}),s(Ie,null,{default:f(()=>[s(N,{value:"historicResults"},{default:f(()=>[s(P)]),_:1}),s(N,{value:"run"},{default:f(()=>[s(qe)]),_:1}),s(N,{value:"results"},{default:f(()=>[e(_)&&e(t).activeBot.selectedBacktestResult?(r(),B(Ae,{key:0,"backtest-result":e(t).activeBot.selectedBacktestResult,class:"flex-fill"},null,8,["backtest-result"])):b("",!0)]),_:1}),s(N,{value:"compare-results"},{default:f(()=>[e(u)?(r(),B(Pe,{key:0,"backtest-results":e(t).activeBot.backtestHistory,class:"flex-fill"},null,8,["backtest-results"])):b("",!0)]),_:1}),s(N,{value:"visualize-summary"},{default:f(()=>[e(_)&&e(t).activeBot.selectedBacktestResult?(r(),B(Le,{key:0,trades:e(t).activeBot.selectedBacktestResult.trades,class:"flex-fill"},null,8,["trades"])):b("",!0)]),_:1}),s(N,{value:"visualize",l:""},{default:f(()=>[e(t).activeBot.selectedBacktestResult?(r(),B(De,{key:0,timeframe:e(a),strategy:e(l).strategy,timerange:e(l).timerange,"backtest-result":e(t).activeBot.selectedBacktestResult,"freqai-model":e(l).freqAI.enabled?e(l).freqAI.model:void 0},null,8,["timeframe","strategy","timerange","backtest-result","freqai-model"])):b("",!0)]),_:1})]),_:1})]),_:1},8,["value"]),et(d("small",{class:"text-end bt-running-label"},"Backtest running: "+x(e(t).activeBot.backtestStep)+" "+x(("formatPercent"in g?g.formatPercent:e(F))(e(t).activeBot.backtestProgress,2)),513),[[st,e(t).activeBot.backtestRunning]])])])])}}}),Qa=U(wa,[["__scopeId","data-v-113ff1d5"]]);export{Qa as default};
//# sourceMappingURL=BacktestingView-Cgx4Qiqi.js.map
